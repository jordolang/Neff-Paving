{"version":3,"file":"estimate-form-DiAHIFSz.js","sources":["../../src/map-form-binding.js"],"sourcesContent":["/**\n * Map-to-Form Data Binding\n * Handles communication between ArcGIS measurement components and estimate form\n */\n\nclass MapFormBinding {\n    constructor() {\n        this.measurementData = null;\n        this.boundaryData = null;\n        this.isInitialized = false;\n        this.currentMeasurement = null;\n        this.currentBoundary = null;\n        this.boundaryPreview = null;\n        this.isEditMode = false;\n        this.drawingMetadata = null;\n        \n        this.init();\n    }\n\n    init() {\n        // Wait for DOM to be ready\n        if (document.readyState === 'loading') {\n            document.addEventListener('DOMContentLoaded', () => this.setupBindings());\n        } else {\n            this.setupBindings();\n        }\n    }\n\n    setupBindings() {\n        this.setupIframeMessageListener();\n        this.setupFormButtons();\n        this.updateSubmitButtonState();\n        \n        console.log('Map-to-form binding initialized');\n    }\n\n    /**\n     * Set up message listener for iframe communication\n     */\n    setupIframeMessageListener() {\n        window.addEventListener('message', (event) => {\n            // Ensure message is from our measurement iframe\n            if (event.origin !== window.location.origin) {\n                return;\n            }\n\n            const { type, data } = event.data;\n\n            switch (type) {\n                case 'MEASUREMENT_COMPLETE':\n                    this.handleMeasurementComplete(data);\n                    break;\n                case 'MEASUREMENT_CLEARED':\n                    this.handleMeasurementCleared();\n                    break;\n                case 'MEASUREMENT_ERROR':\n                    this.handleMeasurementError(data);\n                    break;\n                case 'BOUNDARY_COMPLETE':\n                    this.handleBoundaryComplete(data);\n                    break;\n                case 'BOUNDARY_EDIT_START':\n                    this.handleBoundaryEditStart(data);\n                    break;\n                case 'BOUNDARY_EDIT_UPDATE':\n                    this.handleBoundaryEditUpdate(data);\n                    break;\n                case 'BOUNDARY_EDIT_COMPLETE':\n                    this.handleBoundaryEditComplete(data);\n                    break;\n                case 'BOUNDARY_PREVIEW':\n                    this.handleBoundaryPreview(data);\n                    break;\n                case 'BOUNDARY_CLEARED':\n                    this.handleBoundaryCleared();\n                    break;\n                case 'DRAWING_METADATA':\n                    this.handleDrawingMetadata(data);\n                    break;\n            }\n        });\n    }\n\n    /**\n     * Set up form button event listeners\n     */\n    setupFormButtons() {\n        const clearButton = document.getElementById('clear-measurement');\n        const confirmButton = document.getElementById('confirm-measurement');\n        const clearBoundaryButton = document.getElementById('clear-boundary');\n        const confirmBoundaryButton = document.getElementById('confirm-boundary');\n\n        if (clearButton) {\n            clearButton.addEventListener('click', () => this.clearMeasurement());\n        }\n\n        if (confirmButton) {\n            confirmButton.addEventListener('click', () => this.confirmMeasurement());\n        }\n\n        if (clearBoundaryButton) {\n            clearBoundaryButton.addEventListener('click', () => this.clearBoundary());\n        }\n\n        if (confirmBoundaryButton) {\n            confirmBoundaryButton.addEventListener('click', () => this.confirmBoundary());\n        }\n    }\n\n    /**\n     * Handle boundary completion\n     */\n    handleBoundaryComplete(boundaryData) {\n        console.log('Boundary completed:', boundaryData);\n\n        const perimeter = this.calculatePerimeter(boundaryData.geometry);\n        const isValid = this.validateBoundary(boundaryData.geometry);\n\n        if (!isValid) {\n            console.error('Invalid boundary data');\n            this.updateMeasurementStatus('Invalid boundary: minimum 3 vertices required and polygon must be closed', 'error');\n            return;\n        }\n\n        this.boundaryData = {\n            ...boundaryData,\n            perimeter: perimeter,\n            vertexCount: boundaryData.geometry.rings[0].length - 1, // Subtract 1 for closing vertex\n            timestamp: new Date().toISOString()\n        };\n\n        // Update UI\n        this.updateBoundaryDisplay();\n        this.populateBoundaryFields();\n        this.updateSubmitButtonState();\n    }\n\n    /**\n     * Calculate perimeter of the polygon\n     */\n    calculatePerimeter(geometry) {\n        if (!geometry || !geometry.rings) {\n            return 0;\n        }\n\n        // Calculate perimeter based on vertex coordinates\n        const points = geometry.rings[0];\n        let perimeter = 0;\n        for (let i = 0; i < points.length - 1; i++) {\n            const [x1, y1] = points[i];\n            const [x2, y2] = points[i + 1];\n            perimeter += Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n        }\n        // Closing edge (if not already closed)\n        if (!this.isClosedPolygon(points)) {\n            const [x1, y1] = points[0];\n            const [x2, y2] = points[points.length - 1];\n            perimeter += Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n        }\n\n        return perimeter;\n    }\n\n    /**\n     * Validate the boundary data for minimum requirements\n     */\n    validateBoundary(geometry) {\n        if (!geometry || !geometry.rings) {\n            return false;\n        }\n\n        // Minimum number of vertices required (e.g., triangle)\n        const MIN_VERTICES = 3;\n        const points = geometry.rings[0];\n        return points.length >= MIN_VERTICES + 1 && this.isClosedPolygon(points);\n    }\n\n    /**\n     * Check if the polygon is closed\n     */\n    isClosedPolygon(points) {\n        const firstPoint = points[0];\n        const lastPoint = points[points.length - 1];\n        return firstPoint[0] === lastPoint[0] && firstPoint[1] === lastPoint[1];\n    }\n\n    /**\n     * Handle boundary edit start\n     */\n    handleBoundaryEditStart(data) {\n        console.log('Boundary editing started:', data);\n        this.isEditMode = true;\n        this.updateMeasurementStatus('Boundary editing mode active', 'info');\n    }\n\n    /**\n     * Handle boundary edit update\n     */\n    handleBoundaryEditUpdate(data) {\n        console.log('Boundary editing updated:', data);\n        // Update preview during editing\n        this.boundaryPreview = data;\n        this.updateBoundaryPreview();\n    }\n\n    /**\n     * Handle boundary edit complete\n     */\n    handleBoundaryEditComplete(data) {\n        console.log('Boundary editing completed:', data);\n        this.isEditMode = false;\n        this.handleBoundaryComplete(data);\n    }\n\n    /**\n     * Handle boundary preview\n     */\n    handleBoundaryPreview(data) {\n        console.log('Boundary preview:', data);\n        this.boundaryPreview = data;\n        this.updateBoundaryPreview();\n    }\n\n    /**\n     * Handle drawing metadata\n     */\n    handleDrawingMetadata(data) {\n        console.log('Drawing metadata:', data);\n        this.drawingMetadata = {\n            ...data,\n            timestamp: new Date().toISOString()\n        };\n    }\n\n    /**\n     * Update boundary display in UI\n     */\n    updateBoundaryDisplay() {\n        if (!this.boundaryData) return;\n\n        const statusElement = document.getElementById('boundary-status');\n        if (statusElement) {\n            statusElement.innerHTML = `\n                <div class=\"boundary-success\">\n                    <span class=\"status-indicator\">✅</span>\n                    <span class=\"status-text\">Boundary drawn successfully</span>\n                </div>\n            `;\n        }\n\n        // Update perimeter display\n        const perimeterElement = document.getElementById('boundary-perimeter-display');\n        if (perimeterElement) {\n            perimeterElement.textContent = `${this.boundaryData.perimeter.toLocaleString()} units`;\n        }\n\n        // Update vertex count display\n        const vertexElement = document.getElementById('boundary-vertices-display');\n        if (vertexElement) {\n            vertexElement.textContent = `${this.boundaryData.vertexCount} vertices`;\n        }\n    }\n\n    /**\n     * Update boundary preview display\n     */\n    updateBoundaryPreview() {\n        if (!this.boundaryPreview) return;\n\n        const previewElement = document.getElementById('boundary-preview');\n        if (previewElement) {\n            const previewPerimeter = this.calculatePerimeter(this.boundaryPreview.geometry);\n            const previewVertices = this.boundaryPreview.geometry.rings[0].length - 1;\n            \n            previewElement.innerHTML = `\n                <div class=\"boundary-preview\">\n                    <span class=\"preview-text\">Preview: ${previewVertices} vertices, ${previewPerimeter.toLocaleString()} units perimeter</span>\n                </div>\n            `;\n        }\n    }\n\n    /**\n     * Populate form fields with boundary data\n     */\n    populateBoundaryFields() {\n        if (!this.boundaryData) return;\n\n        // Store boundary coordinates\n        const boundaryCoordinatesField = document.getElementById('boundary-coordinates');\n        if (boundaryCoordinatesField) {\n            boundaryCoordinatesField.value = JSON.stringify(this.boundaryData.geometry);\n        }\n\n        // Store perimeter\n        const perimeterField = document.getElementById('boundary-perimeter');\n        if (perimeterField) {\n            perimeterField.value = this.boundaryData.perimeter.toString();\n        }\n\n        // Store vertex count\n        const vertexCountField = document.getElementById('boundary-vertex-count');\n        if (vertexCountField) {\n            vertexCountField.value = this.boundaryData.vertexCount.toString();\n        }\n\n        // Store drawing metadata\n        const drawingMetadataField = document.getElementById('drawing-metadata');\n        if (drawingMetadataField && this.drawingMetadata) {\n            drawingMetadataField.value = JSON.stringify(this.drawingMetadata);\n        }\n\n        // Store boundary timestamp\n        const boundaryTimestampField = document.getElementById('boundary-timestamp');\n        if (boundaryTimestampField) {\n            boundaryTimestampField.value = this.boundaryData.timestamp;\n        }\n    }\n\n    /**\n     * Clear boundary data\n     */\n    handleBoundaryCleared() {\n        console.log('Boundary cleared');\n        this.boundaryData = null;\n        this.boundaryPreview = null;\n        this.isEditMode = false;\n\n        const fields = [\n            'boundary-coordinates',\n            'boundary-perimeter',\n            'boundary-vertex-count',\n            'drawing-metadata',\n            'boundary-timestamp'\n        ];\n        \n        fields.forEach(fieldId => {\n            const field = document.getElementById(fieldId);\n            if (field) {\n                field.value = '';\n            }\n        });\n\n        // Clear display elements\n        const statusElement = document.getElementById('boundary-status');\n        if (statusElement) {\n            statusElement.innerHTML = '';\n        }\n\n        const previewElement = document.getElementById('boundary-preview');\n        if (previewElement) {\n            previewElement.innerHTML = '';\n        }\n    }\n\n    /**\n     * Clear boundary (triggered by clear button)\n     */\n    clearBoundary() {\n        // Send message to iframe to clear boundary\n        const iframe = document.getElementById('arcgis-measurement-iframe');\n        if (iframe && iframe.contentWindow) {\n            iframe.contentWindow.postMessage({\n                type: 'CLEAR_BOUNDARY'\n            }, window.location.origin);\n        }\n\n        // Clear local data\n        this.handleBoundaryCleared();\n    }\n\n    /**\n     * Confirm boundary (triggered by confirm button)\n     */\n    confirmBoundary() {\n        if (!this.boundaryData) {\n            alert('No boundary data to confirm');\n            return;\n        }\n\n        // Update status\n        this.updateMeasurementStatus(\n            `Confirmed boundary: ${this.boundaryData.vertexCount} vertices, ${this.boundaryData.perimeter.toLocaleString()} units perimeter`,\n            'success'\n        );\n\n        // Mark as confirmed\n        const boundaryContainer = document.querySelector('.boundary-container');\n        if (boundaryContainer) {\n            boundaryContainer.classList.add('boundary-confirmed');\n        }\n    }\n\n    /**\n     * Handle measurement completion from ArcGIS component\n     */\n    handleMeasurementComplete(measurementData) {\n        console.log('Measurement completed:', measurementData);\n        \n        this.currentMeasurement = measurementData;\n        \n        // Extract area data\n        const area = measurementData.area || 0;\n        const unit = measurementData.unit || 'square-meters';\n        const coordinates = measurementData.geometry || null;\n        \n        // Convert to square feet if needed\n        const areaInSqFt = this.convertToSquareFeet(area, unit);\n        \n        // Update measurement data\n        this.measurementData = {\n            area: areaInSqFt,\n            originalArea: area,\n            originalUnit: unit,\n            coordinates: coordinates,\n            timestamp: new Date().toISOString()\n        };\n\n        // Update UI\n        this.updateMeasurementDisplay(areaInSqFt);\n        this.populateHiddenFields();\n        this.updateSubmitButtonState();\n        \n        // Show measurement results section\n        this.showMeasurementResults();\n    }\n\n    /**\n     * Handle measurement cleared\n     */\n    handleMeasurementCleared() {\n        console.log('Measurement cleared');\n        \n        this.currentMeasurement = null;\n        this.measurementData = null;\n        \n        // Clear form fields\n        this.clearHiddenFields();\n        \n        // Update UI\n        this.hideMeasurementResults();\n        this.updateMeasurementStatus('Please measure your project area to proceed');\n        this.updateSubmitButtonState();\n    }\n\n    /**\n     * Handle measurement error\n     */\n    handleMeasurementError(error) {\n        console.error('Measurement error:', error);\n        \n        this.updateMeasurementStatus(`Error: ${error.message || 'Measurement failed'}`, 'error');\n    }\n\n    /**\n     * Convert area to square feet\n     */\n    convertToSquareFeet(area, unit) {\n        const conversions = {\n            'square-meters': 10.7639,\n            'square-feet': 1,\n            'acres': 43560,\n            'sqm': 10.7639,\n            'sqft': 1,\n            'm²': 10.7639,\n            'ft²': 1\n        };\n\n        const multiplier = conversions[unit] || conversions['square-meters'];\n        return area * multiplier;\n    }\n\n    /**\n     * Update measurement display in the UI\n     */\n    updateMeasurementDisplay(areaInSqFt) {\n        const statusElement = document.getElementById('measurement-status');\n        if (statusElement) {\n            statusElement.innerHTML = `\n                <div class=\"measurement-success\">\n                    <span class=\"status-indicator\">✅</span>\n                    <span class=\"status-text\">Area measured successfully</span>\n                </div>\n            `;\n        }\n\n        // Update measured area display\n        const measuredAreaElement = document.getElementById('measured-area');\n        if (measuredAreaElement) {\n            measuredAreaElement.textContent = `${areaInSqFt.toLocaleString()} sq ft`;\n        }\n\n        // Update coordinates display\n        const coordsElement = document.getElementById('measured-coordinates');\n        if (coordsElement && this.measurementData.coordinates) {\n            const coordsText = this.formatCoordinates(this.measurementData.coordinates);\n            coordsElement.textContent = coordsText;\n        }\n    }\n\n    /**\n     * Format coordinates for display\n     */\n    formatCoordinates(geometry) {\n        if (!geometry || !geometry.rings) {\n            return 'Coordinates available';\n        }\n\n        const pointCount = geometry.rings[0]?.length || 0;\n        return `${pointCount} coordinate points`;\n    }\n\n    /**\n     * Populate hidden form fields with measurement data\n     */\n    populateHiddenFields() {\n        if (!this.measurementData) return;\n\n        // Area coordinates\n        const coordsField = document.getElementById('area-coordinates');\n        if (coordsField) {\n            coordsField.value = JSON.stringify(this.measurementData.coordinates);\n        }\n\n        // Square footage\n        const areaField = document.getElementById('square-footage');\n        if (areaField) {\n            areaField.value = this.measurementData.area.toString();\n        }\n\n        // Additional hidden fields from estimate form\n        const calcAreaField = document.getElementById('calculatedSquareFootage');\n        if (calcAreaField) {\n            calcAreaField.value = this.measurementData.area.toString();\n        }\n\n        const timestampField = document.getElementById('measurementTimestamp');\n        if (timestampField) {\n            timestampField.value = this.measurementData.timestamp;\n        }\n\n        const toolField = document.getElementById('measurementTool');\n        if (toolField) {\n            toolField.value = 'arcgis-3d';\n        }\n    }\n\n    /**\n     * Clear hidden form fields\n     */\n    clearHiddenFields() {\n        const fields = [\n            'area-coordinates',\n            'square-footage', \n            'calculatedSquareFootage',\n            'measurementTimestamp',\n            'measurementTool',\n            'boundary-coordinates',\n            'boundary-perimeter',\n            'boundary-vertex-count',\n            'drawing-metadata',\n            'boundary-timestamp'\n        ];\n\n        fields.forEach(fieldId => {\n            const field = document.getElementById(fieldId);\n            if (field) {\n                field.value = '';\n            }\n        });\n    }\n\n    /**\n     * Show measurement results section\n     */\n    showMeasurementResults() {\n        const resultsSection = document.getElementById('measurement-results');\n        if (resultsSection) {\n            resultsSection.style.display = 'block';\n        }\n    }\n\n    /**\n     * Hide measurement results section\n     */\n    hideMeasurementResults() {\n        const resultsSection = document.getElementById('measurement-results');\n        if (resultsSection) {\n            resultsSection.style.display = 'none';\n        }\n    }\n\n    /**\n     * Update measurement status message\n     */\n    updateMeasurementStatus(message, type = 'info') {\n        const statusElement = document.getElementById('measurement-status');\n        if (!statusElement) return;\n\n        const icons = {\n            info: '⚠️',\n            success: '✅',\n            error: '❌'\n        };\n\n        statusElement.innerHTML = `\n            <span class=\"status-indicator\">${icons[type]}</span>\n            <span class=\"status-text\">${message}</span>\n        `;\n    }\n\n    /**\n     * Update submit button state based on measurement data\n     */\n    updateSubmitButtonState() {\n        const submitButton = document.getElementById('submit-button') || \n                           document.getElementById('submit-estimate');\n        \n        if (!submitButton) return;\n\n        const hasValidMeasurement = this.measurementData && this.measurementData.area > 0;\n        const hasRequiredFields = this.checkRequiredFields();\n\n        submitButton.disabled = !hasValidMeasurement || !hasRequiredFields;\n\n        // Update button text\n        if (hasValidMeasurement) {\n            const btnText = submitButton.querySelector('.btn-text') || submitButton;\n            if (btnText.textContent.includes('area')) {\n                btnText.textContent = 'Submit Estimate';\n            }\n        }\n    }\n\n    /**\n     * Check if required form fields are filled\n     */\n    checkRequiredFields() {\n        const requiredFields = [\n            'firstName', 'lastName', 'email', 'phone', \n            'serviceType', 'streetAddress', 'city', 'state', 'zipCode'\n        ];\n\n        return requiredFields.every(fieldName => {\n            const field = document.getElementById(fieldName) || \n                         document.querySelector(`[name=\"${fieldName}\"]`);\n            return field && field.value.trim();\n        });\n    }\n\n    /**\n     * Clear measurement (triggered by clear button)\n     */\n    clearMeasurement() {\n        // Send message to iframe to clear measurement\n        const iframe = document.getElementById('arcgis-measurement-iframe');\n        if (iframe && iframe.contentWindow) {\n            iframe.contentWindow.postMessage({\n                type: 'CLEAR_MEASUREMENT'\n            }, window.location.origin);\n        }\n\n        // Clear local data\n        this.handleMeasurementCleared();\n    }\n\n    /**\n     * Confirm measurement (triggered by confirm button)\n     */\n    confirmMeasurement() {\n        if (!this.measurementData) {\n            alert('No measurement data to confirm');\n            return;\n        }\n\n        // Hide measurement tools and show confirmed status\n        this.updateMeasurementStatus(\n            `Confirmed: ${this.measurementData.area.toLocaleString()} sq ft`, \n            'success'\n        );\n        \n        // Optionally collapse the measurement section\n        const measurementContainer = document.querySelector('.measurement-container');\n        if (measurementContainer) {\n            measurementContainer.classList.add('measurement-confirmed');\n        }\n    }\n\n    /**\n     * Get current measurement data\n     */\n    getMeasurementData() {\n        return this.measurementData;\n    }\n\n    /**\n     * Get current boundary data\n     */\n    getBoundaryData() {\n        return this.boundaryData;\n    }\n\n    /**\n     * Get current boundary preview data\n     */\n    getBoundaryPreview() {\n        return this.boundaryPreview;\n    }\n\n    /**\n     * Get drawing metadata\n     */\n    getDrawingMetadata() {\n        return this.drawingMetadata;\n    }\n\n    /**\n     * Check if measurement is complete\n     */\n    hasMeasurement() {\n        return this.measurementData && this.measurementData.area > 0;\n    }\n\n    /**\n     * Check if boundary is complete\n     */\n    hasBoundary() {\n        return this.boundaryData && this.boundaryData.geometry && this.validateBoundary(this.boundaryData.geometry);\n    }\n\n    /**\n     * Check if currently in edit mode\n     */\n    isInEditMode() {\n        return this.isEditMode;\n    }\n\n    /**\n     * Process vertex coordinates for storage\n     */\n    processVertexCoordinates(geometry) {\n        if (!geometry || !geometry.rings) {\n            return [];\n        }\n\n        const vertices = geometry.rings[0];\n        return vertices.map((vertex, index) => ({\n            index: index,\n            x: vertex[0],\n            y: vertex[1],\n            z: vertex[2] || 0 // Include elevation if available\n        }));\n    }\n\n    /**\n     * Convert perimeter to different units\n     */\n    convertPerimeter(perimeter, fromUnit, toUnit) {\n        const conversions = {\n            'meters': 1,\n            'feet': 3.28084,\n            'yards': 1.09361,\n            'miles': 0.000621371\n        };\n\n        const fromMultiplier = conversions[fromUnit] || 1;\n        const toMultiplier = conversions[toUnit] || 1;\n        \n        return (perimeter / fromMultiplier) * toMultiplier;\n    }\n}\n\n// Initialize when script loads\nconst mapFormBinding = new MapFormBinding();\n\n// Export for use in other scripts\nwindow.MapFormBinding = MapFormBinding;\nwindow.mapFormBinding = mapFormBinding;\n\nexport default MapFormBinding;\n"],"names":["MapFormBinding","constructor","this","measurementData","boundaryData","isInitialized","currentMeasurement","currentBoundary","boundaryPreview","isEditMode","drawingMetadata","init","document","readyState","addEventListener","setupBindings","setupIframeMessageListener","setupFormButtons","updateSubmitButtonState","console","log","window","event","origin","location","type","data","handleMeasurementComplete","handleMeasurementCleared","handleMeasurementError","handleBoundaryComplete","handleBoundaryEditStart","handleBoundaryEditUpdate","handleBoundaryEditComplete","handleBoundaryPreview","handleBoundaryCleared","handleDrawingMetadata","clearButton","getElementById","confirmButton","clearBoundaryButton","confirmBoundaryButton","clearMeasurement","confirmMeasurement","clearBoundary","confirmBoundary","perimeter","calculatePerimeter","geometry","validateBoundary","error","updateMeasurementStatus","vertexCount","rings","length","timestamp","Date","toISOString","updateBoundaryDisplay","populateBoundaryFields","points","i","x1","y1","x2","y2","Math","sqrt","pow","isClosedPolygon","MIN_VERTICES","firstPoint","lastPoint","updateBoundaryPreview","statusElement","innerHTML","perimeterElement","textContent","toLocaleString","vertexElement","previewElement","previewPerimeter","previewVertices","boundaryCoordinatesField","value","JSON","stringify","perimeterField","toString","vertexCountField","drawingMetadataField","boundaryTimestampField","forEach","fieldId","field","iframe","contentWindow","postMessage","alert","boundaryContainer","querySelector","classList","add","area","unit","coordinates","areaInSqFt","convertToSquareFeet","originalArea","originalUnit","updateMeasurementDisplay","populateHiddenFields","showMeasurementResults","clearHiddenFields","hideMeasurementResults","message","conversions","acres","sqm","sqft","measuredAreaElement","coordsElement","coordsText","formatCoordinates","_a","coordsField","areaField","calcAreaField","timestampField","toolField","resultsSection","style","display","info","success","submitButton","hasValidMeasurement","hasRequiredFields","checkRequiredFields","disabled","btnText","includes","every","fieldName","trim","measurementContainer","getMeasurementData","getBoundaryData","getBoundaryPreview","getDrawingMetadata","hasMeasurement","hasBoundary","isInEditMode","processVertexCoordinates","map","vertex","index","x","y","z","convertPerimeter","fromUnit","toUnit","meters","feet","yards","miles","mapFormBinding"],"mappings":"wEAKA,MAAMA,EACF,WAAAC,GACIC,KAAKC,gBAAkB,KACvBD,KAAKE,aAAe,KACpBF,KAAKG,eAAgB,EACrBH,KAAKI,mBAAqB,KAC1BJ,KAAKK,gBAAkB,KACvBL,KAAKM,gBAAkB,KACvBN,KAAKO,YAAa,EAClBP,KAAKQ,gBAAkB,KAEvBR,KAAKS,MACb,CAEI,IAAAA,GAEgC,YAAxBC,SAASC,WACTD,SAASE,iBAAiB,mBAAoB,IAAMZ,KAAKa,iBAEzDb,KAAKa,eAEjB,CAEI,aAAAA,GACIb,KAAKc,6BACLd,KAAKe,mBACLf,KAAKgB,0BAELC,QAAQC,IAAI,kCACpB,CAKI,0BAAAJ,GACIK,OAAOP,iBAAiB,UAAYQ,IAEhC,GAAIA,EAAMC,SAAWF,OAAOG,SAASD,OACjC,OAGJ,MAAME,KAAEA,EAAAC,KAAMA,GAASJ,EAAMI,KAE7B,OAAQD,GACJ,IAAK,uBACDvB,KAAKyB,0BAA0BD,GAC/B,MACJ,IAAK,sBACDxB,KAAK0B,2BACL,MACJ,IAAK,oBACD1B,KAAK2B,uBAAuBH,GAC5B,MACJ,IAAK,oBACDxB,KAAK4B,uBAAuBJ,GAC5B,MACJ,IAAK,sBACDxB,KAAK6B,wBAAwBL,GAC7B,MACJ,IAAK,uBACDxB,KAAK8B,yBAAyBN,GAC9B,MACJ,IAAK,yBACDxB,KAAK+B,2BAA2BP,GAChC,MACJ,IAAK,mBACDxB,KAAKgC,sBAAsBR,GAC3B,MACJ,IAAK,mBACDxB,KAAKiC,wBACL,MACJ,IAAK,mBACDjC,KAAKkC,sBAAsBV,KAI/C,CAKI,gBAAAT,GACI,MAAMoB,EAAczB,SAAS0B,eAAe,qBACtCC,EAAgB3B,SAAS0B,eAAe,uBACxCE,EAAsB5B,SAAS0B,eAAe,kBAC9CG,EAAwB7B,SAAS0B,eAAe,oBAElDD,GACAA,EAAYvB,iBAAiB,QAAS,IAAMZ,KAAKwC,oBAGjDH,GACAA,EAAczB,iBAAiB,QAAS,IAAMZ,KAAKyC,sBAGnDH,GACAA,EAAoB1B,iBAAiB,QAAS,IAAMZ,KAAK0C,iBAGzDH,GACAA,EAAsB3B,iBAAiB,QAAS,IAAMZ,KAAK2C,kBAEvE,CAKI,sBAAAf,CAAuB1B,GACnBe,QAAQC,IAAI,sBAAuBhB,GAEnC,MAAM0C,EAAY5C,KAAK6C,mBAAmB3C,EAAa4C,UAGvD,IAFgB9C,KAAK+C,iBAAiB7C,EAAa4C,UAK/C,OAFA7B,QAAQ+B,MAAM,8BACdhD,KAAKiD,wBAAwB,2EAA4E,SAI7GjD,KAAKE,aAAe,IACbA,EACH0C,YACAM,YAAahD,EAAa4C,SAASK,MAAM,GAAGC,OAAS,EACrDC,WAAA,IAAeC,MAAOC,eAI1BvD,KAAKwD,wBACLxD,KAAKyD,yBACLzD,KAAKgB,yBACb,CAKI,kBAAA6B,CAAmBC,GACf,IAAKA,IAAaA,EAASK,MACvB,OAAO,EAIX,MAAMO,EAASZ,EAASK,MAAM,GAC9B,IAAIP,EAAY,EAChB,IAAA,IAASe,EAAI,EAAGA,EAAID,EAAON,OAAS,EAAGO,IAAK,CACxC,MAAOC,EAAIC,GAAMH,EAAOC,IACjBG,EAAIC,GAAML,EAAOC,EAAI,GAC5Bf,GAAaoB,KAAKC,KAAKD,KAAKE,IAAIJ,EAAKF,EAAI,GAAKI,KAAKE,IAAIH,EAAKF,EAAI,GAC5E,CAEQ,IAAK7D,KAAKmE,gBAAgBT,GAAS,CAC/B,MAAOE,EAAIC,GAAMH,EAAO,IACjBI,EAAIC,GAAML,EAAOA,EAAON,OAAS,GACxCR,GAAaoB,KAAKC,KAAKD,KAAKE,IAAIJ,EAAKF,EAAI,GAAKI,KAAKE,IAAIH,EAAKF,EAAI,GAC5E,CAEQ,OAAOjB,CACf,CAKI,gBAAAG,CAAiBD,GACb,IAAKA,IAAaA,EAASK,MACvB,OAAO,EAIX,MACMO,EAASZ,EAASK,MAAM,GAC9B,OAAOO,EAAON,QAAUgB,GAAoBpE,KAAKmE,gBAAgBT,EACzE,CAKI,eAAAS,CAAgBT,GACZ,MAAMW,EAAaX,EAAO,GACpBY,EAAYZ,EAAOA,EAAON,OAAS,GACzC,OAAOiB,EAAW,KAAOC,EAAU,IAAMD,EAAW,KAAOC,EAAU,EAC7E,CAKI,uBAAAzC,CAAwBL,GACpBP,QAAQC,IAAI,4BAA6BM,GACzCxB,KAAKO,YAAa,EAClBP,KAAKiD,wBAAwB,+BAAgC,OACrE,CAKI,wBAAAnB,CAAyBN,GACrBP,QAAQC,IAAI,4BAA6BM,GAEzCxB,KAAKM,gBAAkBkB,EACvBxB,KAAKuE,uBACb,CAKI,0BAAAxC,CAA2BP,GACvBP,QAAQC,IAAI,8BAA+BM,GAC3CxB,KAAKO,YAAa,EAClBP,KAAK4B,uBAAuBJ,EACpC,CAKI,qBAAAQ,CAAsBR,GAClBP,QAAQC,IAAI,oBAAqBM,GACjCxB,KAAKM,gBAAkBkB,EACvBxB,KAAKuE,uBACb,CAKI,qBAAArC,CAAsBV,GAClBP,QAAQC,IAAI,oBAAqBM,GACjCxB,KAAKQ,gBAAkB,IAChBgB,EACH6B,WAAA,IAAeC,MAAOC,cAElC,CAKI,qBAAAC,GACI,IAAKxD,KAAKE,aAAc,OAExB,MAAMsE,EAAgB9D,SAAS0B,eAAe,mBAC1CoC,IACAA,EAAcC,UAAY,yOAS9B,MAAMC,EAAmBhE,SAAS0B,eAAe,8BAC7CsC,IACAA,EAAiBC,YAAc,GAAG3E,KAAKE,aAAa0C,UAAUgC,0BAIlE,MAAMC,EAAgBnE,SAAS0B,eAAe,6BAC1CyC,IACAA,EAAcF,YAAc,GAAG3E,KAAKE,aAAagD,uBAE7D,CAKI,qBAAAqB,GACI,IAAKvE,KAAKM,gBAAiB,OAE3B,MAAMwE,EAAiBpE,SAAS0B,eAAe,oBAC/C,GAAI0C,EAAgB,CAChB,MAAMC,EAAmB/E,KAAK6C,mBAAmB7C,KAAKM,gBAAgBwC,UAChEkC,EAAkBhF,KAAKM,gBAAgBwC,SAASK,MAAM,GAAGC,OAAS,EAExE0B,EAAeL,UAAY,6GAEmBO,eAA6BD,EAAiBH,+EAGxG,CACA,CAKI,sBAAAnB,GACI,IAAKzD,KAAKE,aAAc,OAGxB,MAAM+E,EAA2BvE,SAAS0B,eAAe,wBACrD6C,IACAA,EAAyBC,MAAQC,KAAKC,UAAUpF,KAAKE,aAAa4C,WAItE,MAAMuC,EAAiB3E,SAAS0B,eAAe,sBAC3CiD,IACAA,EAAeH,MAAQlF,KAAKE,aAAa0C,UAAU0C,YAIvD,MAAMC,EAAmB7E,SAAS0B,eAAe,yBAC7CmD,IACAA,EAAiBL,MAAQlF,KAAKE,aAAagD,YAAYoC,YAI3D,MAAME,EAAuB9E,SAAS0B,eAAe,oBACjDoD,GAAwBxF,KAAKQ,kBAC7BgF,EAAqBN,MAAQC,KAAKC,UAAUpF,KAAKQ,kBAIrD,MAAMiF,EAAyB/E,SAAS0B,eAAe,sBACnDqD,IACAA,EAAuBP,MAAQlF,KAAKE,aAAamD,UAE7D,CAKI,qBAAApB,GACIhB,QAAQC,IAAI,oBACZlB,KAAKE,aAAe,KACpBF,KAAKM,gBAAkB,KACvBN,KAAKO,YAAa,EAEH,CACX,uBACA,qBACA,wBACA,mBACA,sBAGGmF,QAAQC,IACX,MAAMC,EAAQlF,SAAS0B,eAAeuD,GAClCC,IACAA,EAAMV,MAAQ,MAKtB,MAAMV,EAAgB9D,SAAS0B,eAAe,mBAC1CoC,IACAA,EAAcC,UAAY,IAG9B,MAAMK,EAAiBpE,SAAS0B,eAAe,oBAC3C0C,IACAA,EAAeL,UAAY,GAEvC,CAKI,aAAA/B,GAEI,MAAMmD,EAASnF,SAAS0B,eAAe,6BACnCyD,GAAUA,EAAOC,eACjBD,EAAOC,cAAcC,YAAY,CAC7BxE,KAAM,kBACPJ,OAAOG,SAASD,QAIvBrB,KAAKiC,uBACb,CAKI,eAAAU,GACI,IAAK3C,KAAKE,aAEN,YADA8F,MAAM,+BAKVhG,KAAKiD,wBACD,uBAAuBjD,KAAKE,aAAagD,yBAAyBlD,KAAKE,aAAa0C,UAAUgC,mCAC9F,WAIJ,MAAMqB,EAAoBvF,SAASwF,cAAc,uBAC7CD,GACAA,EAAkBE,UAAUC,IAAI,qBAE5C,CAKI,yBAAA3E,CAA0BxB,GACtBgB,QAAQC,IAAI,yBAA0BjB,GAEtCD,KAAKI,mBAAqBH,EAG1B,MAAMoG,EAAOpG,EAAgBoG,MAAQ,EAC/BC,EAAOrG,EAAgBqG,MAAQ,gBAC/BC,EAActG,EAAgB6C,UAAY,KAG1C0D,EAAaxG,KAAKyG,oBAAoBJ,EAAMC,GAGlDtG,KAAKC,gBAAkB,CACnBoG,KAAMG,EACNE,aAAcL,EACdM,aAAcL,EACdC,cACAlD,WAAA,IAAeC,MAAOC,eAI1BvD,KAAK4G,yBAAyBJ,GAC9BxG,KAAK6G,uBACL7G,KAAKgB,0BAGLhB,KAAK8G,wBACb,CAKI,wBAAApF,GACIT,QAAQC,IAAI,uBAEZlB,KAAKI,mBAAqB,KAC1BJ,KAAKC,gBAAkB,KAGvBD,KAAK+G,oBAGL/G,KAAKgH,yBACLhH,KAAKiD,wBAAwB,+CAC7BjD,KAAKgB,yBACb,CAKI,sBAAAW,CAAuBqB,GACnB/B,QAAQ+B,MAAM,qBAAsBA,GAEpChD,KAAKiD,wBAAwB,UAAUD,EAAMiE,SAAW,uBAAwB,QACxF,CAKI,mBAAAR,CAAoBJ,EAAMC,GACtB,MAAMY,EAAc,CAChB,gBAAiB,QACjB,cAAe,EACfC,MAAS,MACTC,IAAO,QACPC,KAAQ,EACR,KAAM,QACN,MAAO,GAIX,OAAOhB,GADYa,EAAYZ,IAASY,EAAY,iBAE5D,CAKI,wBAAAN,CAAyBJ,GACrB,MAAMhC,EAAgB9D,SAAS0B,eAAe,sBAC1CoC,IACAA,EAAcC,UAAY,2OAS9B,MAAM6C,EAAsB5G,SAAS0B,eAAe,iBAChDkF,IACAA,EAAoB3C,YAAc,GAAG6B,EAAW5B,0BAIpD,MAAM2C,EAAgB7G,SAAS0B,eAAe,wBAC9C,GAAImF,GAAiBvH,KAAKC,gBAAgBsG,YAAa,CACnD,MAAMiB,EAAaxH,KAAKyH,kBAAkBzH,KAAKC,gBAAgBsG,aAC/DgB,EAAc5C,YAAc6C,CACxC,CACA,CAKI,iBAAAC,CAAkB3E,SACd,IAAKA,IAAaA,EAASK,MACvB,MAAO,wBAIX,MAAO,IADY,OAAAuE,EAAA5E,EAASK,MAAM,aAAIC,SAAU,qBAExD,CAKI,oBAAAyD,GACI,IAAK7G,KAAKC,gBAAiB,OAG3B,MAAM0H,EAAcjH,SAAS0B,eAAe,oBACxCuF,IACAA,EAAYzC,MAAQC,KAAKC,UAAUpF,KAAKC,gBAAgBsG,cAI5D,MAAMqB,EAAYlH,SAAS0B,eAAe,kBACtCwF,IACAA,EAAU1C,MAAQlF,KAAKC,gBAAgBoG,KAAKf,YAIhD,MAAMuC,EAAgBnH,SAAS0B,eAAe,2BAC1CyF,IACAA,EAAc3C,MAAQlF,KAAKC,gBAAgBoG,KAAKf,YAGpD,MAAMwC,EAAiBpH,SAAS0B,eAAe,wBAC3C0F,IACAA,EAAe5C,MAAQlF,KAAKC,gBAAgBoD,WAGhD,MAAM0E,EAAYrH,SAAS0B,eAAe,mBACtC2F,IACAA,EAAU7C,MAAQ,YAE9B,CAKI,iBAAA6B,GACmB,CACX,mBACA,iBACA,0BACA,uBACA,kBACA,uBACA,qBACA,wBACA,mBACA,sBAGGrB,QAAQC,IACX,MAAMC,EAAQlF,SAAS0B,eAAeuD,GAClCC,IACAA,EAAMV,MAAQ,KAG9B,CAKI,sBAAA4B,GACI,MAAMkB,EAAiBtH,SAAS0B,eAAe,uBAC3C4F,IACAA,EAAeC,MAAMC,QAAU,QAE3C,CAKI,sBAAAlB,GACI,MAAMgB,EAAiBtH,SAAS0B,eAAe,uBAC3C4F,IACAA,EAAeC,MAAMC,QAAU,OAE3C,CAKI,uBAAAjF,CAAwBgE,EAAS1F,EAAO,QACpC,MAAMiD,EAAgB9D,SAAS0B,eAAe,sBAC9C,IAAKoC,EAAe,OAQpBA,EAAcC,UAAY,gDANZ,CACV0D,KAAM,KACNC,QAAS,IACTpF,MAAO,KAIgCzB,oDACX0F,oBAExC,CAKI,uBAAAjG,GACI,MAAMqH,EAAe3H,SAAS0B,eAAe,kBAC1B1B,SAAS0B,eAAe,mBAE3C,IAAKiG,EAAc,OAEnB,MAAMC,EAAsBtI,KAAKC,iBAAmBD,KAAKC,gBAAgBoG,KAAO,EAC1EkC,EAAoBvI,KAAKwI,sBAK/B,GAHAH,EAAaI,UAAYH,IAAwBC,EAG7CD,EAAqB,CACrB,MAAMI,EAAUL,EAAanC,cAAc,cAAgBmC,EACvDK,EAAQ/D,YAAYgE,SAAS,UAC7BD,EAAQ/D,YAAc,kBAEtC,CACA,CAKI,mBAAA6D,GAMI,MALuB,CACnB,YAAa,WAAY,QAAS,QAClC,cAAe,gBAAiB,OAAQ,QAAS,WAG/BI,MAAMC,IACxB,MAAMjD,EAAQlF,SAAS0B,eAAeyG,IACzBnI,SAASwF,cAAc,UAAU2C,OAC9C,OAAOjD,GAASA,EAAMV,MAAM4D,QAExC,CAKI,gBAAAtG,GAEI,MAAMqD,EAASnF,SAAS0B,eAAe,6BACnCyD,GAAUA,EAAOC,eACjBD,EAAOC,cAAcC,YAAY,CAC7BxE,KAAM,qBACPJ,OAAOG,SAASD,QAIvBrB,KAAK0B,0BACb,CAKI,kBAAAe,GACI,IAAKzC,KAAKC,gBAEN,YADA+F,MAAM,kCAKVhG,KAAKiD,wBACD,cAAcjD,KAAKC,gBAAgBoG,KAAKzB,yBACxC,WAIJ,MAAMmE,EAAuBrI,SAASwF,cAAc,0BAChD6C,GACAA,EAAqB5C,UAAUC,IAAI,wBAE/C,CAKI,kBAAA4C,GACI,OAAOhJ,KAAKC,eACpB,CAKI,eAAAgJ,GACI,OAAOjJ,KAAKE,YACpB,CAKI,kBAAAgJ,GACI,OAAOlJ,KAAKM,eACpB,CAKI,kBAAA6I,GACI,OAAOnJ,KAAKQ,eACpB,CAKI,cAAA4I,GACI,OAAOpJ,KAAKC,iBAAmBD,KAAKC,gBAAgBoG,KAAO,CACnE,CAKI,WAAAgD,GACI,OAAOrJ,KAAKE,cAAgBF,KAAKE,aAAa4C,UAAY9C,KAAK+C,iBAAiB/C,KAAKE,aAAa4C,SAC1G,CAKI,YAAAwG,GACI,OAAOtJ,KAAKO,UACpB,CAKI,wBAAAgJ,CAAyBzG,GACrB,IAAKA,IAAaA,EAASK,MACvB,MAAO,GAIX,OADiBL,EAASK,MAAM,GAChBqG,IAAI,CAACC,EAAQC,KAAA,CACzBA,QACAC,EAAGF,EAAO,GACVG,EAAGH,EAAO,GACVI,EAAGJ,EAAO,IAAM,IAE5B,CAKI,gBAAAK,CAAiBlH,EAAWmH,EAAUC,GAClC,MAAM9C,EAAc,CAChB+C,OAAU,EACVC,KAAQ,QACRC,MAAS,QACTC,MAAS,WAMb,OAAQxH,GAHesE,EAAY6C,IAAa,IAC3B7C,EAAY8C,IAAW,EAGpD,EAIA,MAAMK,EAAiB,IAAIvK,EAG3BqB,OAAOrB,eAAiBA,EACxBqB,OAAOkJ,eAAiBA"}