{"version":3,"file":"chunk-DOUdzTfx.js","sources":["../../src/utils/base-url.js"],"sourcesContent":["/**\r\n * Enhanced Base URL utility for handling different deployment environments\r\n * Provides comprehensive asset handling with relative paths and dynamic resolution\r\n */\r\n\r\n// Get base URL from build-time configuration\r\nexport const BASE_URL = typeof __BASE_URL__ !== 'undefined' ? __BASE_URL__ : '/Neff-Paving/';\r\nexport const DEPLOY_MODE = typeof __DEPLOY_MODE__ !== 'undefined' ? __DEPLOY_MODE__ : 'github';\r\nexport const BUILD_TIMESTAMP = typeof __BUILD_TIMESTAMP__ !== 'undefined' ? __BUILD_TIMESTAMP__ : Date.now();\r\nexport const DEPLOY_TIME = typeof __DEPLOY_TIME__ !== 'undefined' ? __DEPLOY_TIME__ : Date.now();\r\n\r\n// Asset type configurations for different environments\r\nconst ASSET_CONFIG = {\r\n  vercel: {\r\n    useRelativePaths: false,\r\n    assetPrefix: '',\r\n    cdnEnabled: true,\r\n    cacheStrategy: 'aggressive'\r\n  },\r\n  github: {\r\n    useRelativePaths: true,\r\n    assetPrefix: '/Neff-Paving',\r\n    cdnEnabled: false,\r\n    cacheStrategy: 'moderate'\r\n  },\r\n  development: {\r\n    useRelativePaths: false,\r\n    assetPrefix: '',\r\n    cdnEnabled: false,\r\n    cacheStrategy: 'none'\r\n  }\r\n};\r\n\r\n/**\r\n * Get the current environment configuration\r\n * @returns {object} Environment-specific asset configuration\r\n */\r\nexport function getEnvironmentConfig() {\r\n  const isDev = typeof process !== 'undefined' && process.env.NODE_ENV === 'development';\r\n  if (isDev) return ASSET_CONFIG.development;\r\n  \r\n  return ASSET_CONFIG[DEPLOY_MODE] || ASSET_CONFIG.github;\r\n}\r\n\r\n/**\r\n * Get the correct base URL for the current environment\r\n * @returns {string} The base URL\r\n */\r\nexport function getBaseUrl() {\r\n  return BASE_URL;\r\n}\r\n\r\n/**\r\n * Create a full URL with the correct base path\r\n * @param {string} path - The path to append to the base URL\r\n * @returns {string} The complete URL\r\n */\r\nexport function createUrl(path) {\r\n  // Remove leading slash if present to avoid double slashes\r\n  const cleanPath = path.startsWith('/') ? path.slice(1) : path;\r\n  \r\n  // Ensure base URL ends with slash\r\n  const baseUrl = BASE_URL.endsWith('/') ? BASE_URL : BASE_URL + '/';\r\n  \r\n  return baseUrl + cleanPath;\r\n}\r\n\r\n/**\r\n * Enhanced asset path resolution with relative path support\r\n * @param {string} assetPath - The asset path\r\n * @param {object} options - Resolution options\r\n * @returns {string} The environment-specific asset path\r\n */\r\nexport function getAssetPath(assetPath, options = {}) {\r\n  const config = getEnvironmentConfig();\r\n  const {\r\n    useRelative = config.useRelativePaths,\r\n    addCacheBusting = true,\r\n    forceAbsolute = false\r\n  } = options;\r\n\r\n  let resolvedPath = assetPath;\r\n\r\n  // Handle different path types\r\n  if (assetPath.startsWith('http://') || assetPath.startsWith('https://')) {\r\n    // External URL - return as-is\r\n    return assetPath;\r\n  }\r\n\r\n  // Remove leading slash for processing\r\n  const cleanPath = assetPath.startsWith('/') ? assetPath.slice(1) : assetPath;\r\n\r\n  if (forceAbsolute || DEPLOY_MODE === 'vercel') {\r\n    // Use absolute paths from root\r\n    resolvedPath = '/' + cleanPath;\r\n  } else if (useRelative && DEPLOY_MODE === 'github') {\r\n    // Use relative paths with base URL for GitHub Pages\r\n    const baseUrl = BASE_URL.endsWith('/') ? BASE_URL.slice(0, -1) : BASE_URL;\r\n    resolvedPath = baseUrl + '/' + cleanPath;\r\n  } else {\r\n    // Default to absolute path\r\n    resolvedPath = '/' + cleanPath;\r\n  }\r\n\r\n  // Add cache busting for non-development environments\r\n  if (addCacheBusting && config.cacheStrategy !== 'none') {\r\n    const separator = resolvedPath.includes('?') ? '&' : '?';\r\n    const timestamp = config.cacheStrategy === 'aggressive' ? DEPLOY_TIME : BUILD_TIMESTAMP;\r\n    resolvedPath += `${separator}v=${timestamp}`;\r\n  }\r\n\r\n  return resolvedPath;\r\n}\r\n\r\n/**\r\n * Critical asset preloading for improved performance\r\n * @param {Array} assets - Array of critical assets to preload\r\n */\r\nexport function preloadCriticalAssets(assets = []) {\r\n  if (typeof document === 'undefined') return;\r\n\r\n  // Default critical assets\r\n  const defaultCriticalAssets = [\r\n    { type: 'style', href: '/assets/main.css', as: 'style' },\r\n    { type: 'script', href: '/src/main.js', as: 'script' },\r\n    { type: 'font', href: 'https://fonts.gstatic.com/s/oswald/v49/TK3IWkUHHAIjg75cFRf3bXL8LICs1_Fw.woff2', as: 'font', crossorigin: true },\r\n    { type: 'image', href: '/assets/images/logo.png', as: 'image' }\r\n  ];\r\n\r\n  const allAssets = [...defaultCriticalAssets, ...assets];\r\n\r\n  allAssets.forEach(asset => {\r\n    // Skip if already preloaded\r\n    const existingLink = document.querySelector(`link[href=\"${asset.href}\"]`);\r\n    if (existingLink) return;\r\n\r\n    const link = document.createElement('link');\r\n    link.rel = asset.type === 'font' ? 'preload' : 'prefetch';\r\n    link.href = getAssetPath(asset.href, { addCacheBusting: false });\r\n    link.as = asset.as;\r\n    \r\n    if (asset.crossorigin) {\r\n      link.crossOrigin = 'anonymous';\r\n    }\r\n    \r\n    if (asset.type === 'font') {\r\n      link.type = 'font/woff2';\r\n    }\r\n\r\n    document.head.appendChild(link);\r\n  });\r\n}\r\n\r\n/**\r\n * Enhanced asset path updating with improved error handling\r\n */\r\nexport function updateAssetPaths() {\r\n  if (typeof document === 'undefined') return;\r\n\r\n  const config = getEnvironmentConfig();\r\n  \r\n  // Update all asset references\r\n  const selectors = [\r\n    'a[href^=\"/\"]:not([href^=\"//\"])',\r\n    'img[src^=\"/\"]:not([src^=\"//\"])',\r\n    'link[href^=\"/\"]:not([href^=\"//\"])',\r\n    'script[src^=\"/\"]:not([src^=\"//\"])',\r\n    'source[src^=\"/\"]:not([src^=\"//\"])',\r\n    'video[src^=\"/\"]:not([src^=\"//\"])',\r\n    'audio[src^=\"/\"]:not([src^=\"//\"])',\r\n    '[style*=\"url(/\"]'\r\n  ];\r\n  \r\n  const elements = document.querySelectorAll(selectors.join(', '));\r\n  \r\n  elements.forEach(element => {\r\n    try {\r\n      const tagName = element.tagName.toLowerCase();\r\n      let attr, currentPath;\r\n      \r\n      // Determine the correct attribute to update\r\n      if (tagName === 'a' || tagName === 'link') {\r\n        attr = 'href';\r\n      } else if (['img', 'script', 'source', 'video', 'audio'].includes(tagName)) {\r\n        attr = 'src';\r\n      } else if (element.hasAttribute('style')) {\r\n        // Handle inline styles with url() references\r\n        const style = element.getAttribute('style');\r\n        const urlMatches = style.match(/url\\(([^)]+)\\)/g);\r\n        if (urlMatches) {\r\n          let updatedStyle = style;\r\n          urlMatches.forEach(match => {\r\n            const url = match.replace(/url\\(['\"]?([^'\"]+)['\"]?\\)/, '$1');\r\n            if (url.startsWith('/') && !url.startsWith('//')) {\r\n              const newUrl = getAssetPath(url);\r\n              updatedStyle = updatedStyle.replace(match, `url(${newUrl})`);\r\n            }\r\n          });\r\n          element.setAttribute('style', updatedStyle);\r\n        }\r\n        return;\r\n      }\r\n      \r\n      if (attr) {\r\n        currentPath = element.getAttribute(attr);\r\n        \r\n        // Only update paths that need updating\r\n        if (currentPath && \r\n            currentPath.startsWith('/') && \r\n            !currentPath.startsWith('//') &&\r\n            !currentPath.startsWith(BASE_URL) && \r\n            !currentPath.startsWith('http')) {\r\n          \r\n          const newPath = getAssetPath(currentPath, {\r\n            addCacheBusting: !element.hasAttribute('data-no-cache-bust')\r\n          });\r\n          element.setAttribute(attr, newPath);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to update asset path for element:', element, error);\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Set cache headers for static assets (for server-side usage)\r\n * @param {string} assetPath - The asset path\r\n * @returns {object} Cache headers object\r\n */\r\nexport function getCacheHeaders(assetPath) {\r\n  const config = getEnvironmentConfig();\r\n  const fileExtension = assetPath.split('.').pop()?.toLowerCase();\r\n  \r\n  // Define cache strategies by file type\r\n  const cacheStrategies = {\r\n    // Long-term cache for immutable assets\r\n    immutable: {\r\n      'Cache-Control': 'public, max-age=31536000, immutable',\r\n      'Expires': new Date(Date.now() + 31536000 * 1000).toUTCString()\r\n    },\r\n    // Medium-term cache for versioned assets\r\n    versioned: {\r\n      'Cache-Control': 'public, max-age=86400, must-revalidate',\r\n      'Expires': new Date(Date.now() + 86400 * 1000).toUTCString()\r\n    },\r\n    // Short-term cache for dynamic content\r\n    dynamic: {\r\n      'Cache-Control': 'public, max-age=3600, must-revalidate',\r\n      'Expires': new Date(Date.now() + 3600 * 1000).toUTCString()\r\n    },\r\n    // No cache for development\r\n    none: {\r\n      'Cache-Control': 'no-cache, no-store, must-revalidate',\r\n      'Pragma': 'no-cache',\r\n      'Expires': '0'\r\n    }\r\n  };\r\n  \r\n  // Map file extensions to cache strategies\r\n  const extensionMap = {\r\n    // Immutable assets (with hash in filename)\r\n    js: assetPath.includes('-') ? 'immutable' : 'versioned',\r\n    css: assetPath.includes('-') ? 'immutable' : 'versioned',\r\n    \r\n    // Image assets\r\n    jpg: 'immutable',\r\n    jpeg: 'immutable',\r\n    png: 'immutable',\r\n    gif: 'immutable',\r\n    svg: 'versioned',\r\n    webp: 'immutable',\r\n    ico: 'immutable',\r\n    \r\n    // Font assets\r\n    woff: 'immutable',\r\n    woff2: 'immutable',\r\n    ttf: 'immutable',\r\n    eot: 'immutable',\r\n    \r\n    // Video assets\r\n    mp4: 'immutable',\r\n    webm: 'immutable',\r\n    \r\n    // Documents\r\n    pdf: 'versioned',\r\n    \r\n    // HTML and other dynamic content\r\n    html: 'dynamic',\r\n    json: 'dynamic'\r\n  };\r\n  \r\n  if (config.cacheStrategy === 'none') {\r\n    return cacheStrategies.none;\r\n  }\r\n  \r\n  const strategy = extensionMap[fileExtension] || 'dynamic';\r\n  const headers = { ...cacheStrategies[strategy] };\r\n  \r\n  // Add additional headers for security and performance\r\n  headers['X-Content-Type-Options'] = 'nosniff';\r\n  headers['Vary'] = 'Accept-Encoding';\r\n  \r\n  // Add CORS headers for assets that might be used cross-origin\r\n  if (['woff', 'woff2', 'ttf', 'eot'].includes(fileExtension)) {\r\n    headers['Access-Control-Allow-Origin'] = '*';\r\n  }\r\n  \r\n  return headers;\r\n}\r\n\r\n/**\r\n * Navigation helper for single-page applications\r\n * @param {string} path - The path to navigate to\r\n */\r\nexport function navigateTo(path) {\r\n  const url = createUrl(path);\r\n  if (typeof window !== 'undefined' && window.history) {\r\n    window.history.pushState({}, '', url);\r\n  }\r\n}\r\n\r\n/**\r\n * Initialize asset optimization features\r\n */\r\nexport function initializeAssetOptimization() {\r\n  if (typeof document === 'undefined') return;\r\n  \r\n  // Preload critical assets\r\n  preloadCriticalAssets();\r\n  \r\n  // Update existing asset paths\r\n  updateAssetPaths();\r\n  \r\n  // Set up intersection observer for lazy loading images\r\n  if ('IntersectionObserver' in window) {\r\n    const imageObserver = new IntersectionObserver((entries, observer) => {\r\n      entries.forEach(entry => {\r\n        if (entry.isIntersecting) {\r\n          const img = entry.target;\r\n          if (img.dataset.src) {\r\n            img.src = getAssetPath(img.dataset.src);\r\n            img.removeAttribute('data-src');\r\n            observer.unobserve(img);\r\n          }\r\n        }\r\n      });\r\n    });\r\n    \r\n    document.querySelectorAll('img[data-src]').forEach(img => {\r\n      imageObserver.observe(img);\r\n    });\r\n  }\r\n}\r\n\r\n// Auto-initialize when module is loaded (for client-side usage)\r\nif (typeof document !== 'undefined' && document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', initializeAssetOptimization);\r\n} else if (typeof document !== 'undefined') {\r\n  // DOM is already loaded\r\n  initializeAssetOptimization();\r\n}\r\n"],"names":[],"mappings":"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"}