{"version":3,"mappings":"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","names":["STORAGE_KEYS","GOOGLE_MAPS_DATA","ARCGIS_DATA","ACTIVE_TOOL","MEASUREMENT_SESSION","storeMeasurementData","toolType","data","key","getStorageKey","storageData","timestamp","Date","toISOString","sessionStorage","setItem","JSON","stringify","updateSessionMetadata","console","log","error","getMeasurementData","stored","getItem","parsedData","parse","dataAge","now","getTime","clearMeasurementData","removeItem","clearAllMeasurementData","Object","values","forEach","getActiveTool","hasMeasurementData","some","getAllMeasurementData","googleMaps","arcgis","activeTool","handleFormSubmission","Error","metadata","lastUpdated","tools","push","initializeStorage","sessionData","parsed","sessionAge","FormValidationService","constructor","this","validationRules","area","min","max","reasonable","residential","commercial","maintenance","custom","emergency","perimeter","measurementToolInstructions","title","description","instructions","benefits","limitations","helpText","serviceTypes","measurementTools","when3DRecommended","when2DAcceptable","tooltips","measurement3D","areaValidation","serviceTypeSelection","addressImportant","timeline","validateAreaMeasurement","serviceType","unit","validation","isValid","warnings","errors","recommendations","areaInSqFt","convertToSquareFeet","toLocaleString","reasonableRange","validatePerimeterMeasurement","perimeterInFt","convertToFeet","ratio","Math","sqrt","getMeasurementToolInstructions","getHelpText","fieldType","subType","getTooltip","elementType","recommendMeasurementTool","projectDescription","hasSlope","recommendation","primary","secondary","reasoning","hasSlopeKeyword","keyword","toLowerCase","includes","validateForm","formData","field","trim","formatFieldName","email","isValidEmail","phone","isValidPhone","areaData","areaInSquareFeet","perimeterValidation","toolRecommendation","getValidationMessage","message","length","join","value","sqft","sqm","acres","ft","m","meters","fieldName","replace","str","toUpperCase","test","cleanPhone","EstimateService","rates","base","premium","modifiers","complexity","simple","moderate","complex","accessibility","easy","difficult","season","peak","regular","offSeason","urgency","standard","rush","materialCosts","asphalt","concrete","sealcoating","striping","laborRates","skilled","semiskilled","general","calculateEstimate","squareFeet","options","estimate","baseCost","materialCost","laborCost","totalCost","days","startDate","endDate","breakdown","modifiedCost","discount","calculateMaterialCost","materials","calculateLaborCost","calculateTimeline","baseRate","getAppliedModifiers","laborHours","calculateLaborHours","totalMaterialCost","material","costPerSqFt","type","coverage","quantity","skillLevel","hours","hoursPerDay","workDays","ceil","bufferDays","totalDays","setDate","getDate","split","applied","multiplier","rate","getAvailableOptions","keys","complexityLevels","accessibilityLevels","seasons","urgencyLevels","materialTypes","skillLevels","EstimateForm","containerId","container","document","getElementById","validationService","estimateService","measurementData","squareFootage","isSubmitting","init","render","attachEventListeners","formatPricingDisplay","loadMeasurementData","updateSubmitButtonState","calculatePricing","innerHTML","form","getQuoteButton","resetButton","serviceTypeSelect","arcgisToggle","googleMapsToggle","addEventListener","e","handleSubmit","handleGetQuote","resetForm","handleServiceTypeChange","handleFieldValidation","toggleMeasurementTool","formatPhoneNumber","setTimeout","initializeMeasurementTools","event","preventDefault","FormData","target","fromEntries","entries","displayValidationErrors","submitForm","_a","submissionData","submittedAt","response","fetch","method","headers","body","ok","result","json","handleSubmitSuccess","handleSubmitError","_b","referenceNumber","__vitePreload","async","Promise","resolve","then","measurementStorage","__VITE_PRELOAD__","errorDiv","createElement","className","insertBefore","firstChild","name","errorElement","textContent","classList","remove","hasAttribute","showFieldError","add","summaryDiv","errorsList","map","style","display","scrollIntoView","behavior","launchMeasurementTool","window","open","updateMeasurementStatus","statusDiv","isLoading","submitButton","btnText","querySelector","btnLoading","getQuoteText","getQuoteLoading","disabled","hasRequiredFields","checkRequiredFields","hasMeasurement","every","confirm","reset","querySelectorAll","el","handleFormReset","loadArcGISMeasurementTool","arcgisContainer","googleMapsContainer","btn","arcgisLoaded","googleMapsLoaded","loadGoogleMapsMeasurementTool","activeMeasurementTool","cssLink","rel","href","head","appendChild","calciteScript","src","scriptTag","onload","mapComponentsScript","initializeArcGISScene","showArcGISError","sceneViewContainer","arcGISResults","lineResult","areaResult","viewElement","directLineMeasurement3d","areaMeasurement3d","expandDirectLine","expandArea","viewOnReady","setupArcGISMeasurementObservers","MutationObserver","mutations","mutation","expanded","start","clear","observe","attributeFilter","detail","distance","toFixed","updateProjectSizeFromMeasurement","round","coordinates","placeholder","alert","pricingData","displayPricing","basePricing","avg","serviceTypePricing","calculations","sizeMultiplier","getSizeMultiplier","seasonMultiplier","getSeasonMultiplier","factors","month","getMonth","pricingDisplay","pricingDetails","formatServiceType","formatMultiplier","getSizeDescription","getSeasonDescription","percentage"],"ignoreList":[],"sources":["../../src/utils/measurement-storage.js","../../src/services/form-validation-service.js","../../src/services/estimate-service.js","../../src/components/estimate-form.js"],"sourcesContent":["/**\n * Measurement Storage Utility\n * Handles persistence of measurement data across tool switches and page reloads\n */\n\nconst STORAGE_KEYS = {\n    GOOGLE_MAPS_DATA: 'neff_paving_google_maps_measurements',\n    ARCGIS_DATA: 'neff_paving_arcgis_measurements',\n    ACTIVE_TOOL: 'neff_paving_active_measurement_tool',\n    MEASUREMENT_SESSION: 'neff_paving_measurement_session'\n};\n\n/**\n * Store measurement data for a specific tool\n */\nexport function storeMeasurementData(toolType, data) {\n    try {\n        const key = getStorageKey(toolType);\n        const storageData = {\n            data,\n            timestamp: new Date().toISOString(),\n            toolType\n        };\n        \n        sessionStorage.setItem(key, JSON.stringify(storageData));\n        \n        // Also update the active tool\n        sessionStorage.setItem(STORAGE_KEYS.ACTIVE_TOOL, toolType);\n        \n        // Update session metadata\n        updateSessionMetadata();\n        \n        console.log(`Measurement data stored for ${toolType}:`, data);\n    } catch (error) {\n        console.error('Failed to store measurement data:', error);\n    }\n}\n\n/**\n * Retrieve measurement data for a specific tool\n */\nexport function getMeasurementData(toolType) {\n    try {\n        const key = getStorageKey(toolType);\n        const stored = sessionStorage.getItem(key);\n        \n        if (!stored) {\n            return null;\n        }\n        \n        const parsedData = JSON.parse(stored);\n        \n        // Check if data is still valid (not older than 24 hours)\n        const dataAge = Date.now() - new Date(parsedData.timestamp).getTime();\n        const maxAge = 24 * 60 * 60 * 1000; // 24 hours\n        \n        if (dataAge > maxAge) {\n            clearMeasurementData(toolType);\n            return null;\n        }\n        \n        return parsedData.data;\n    } catch (error) {\n        console.error('Failed to retrieve measurement data:', error);\n        return null;\n    }\n}\n\n/**\n * Clear measurement data for a specific tool\n */\nexport function clearMeasurementData(toolType) {\n    try {\n        const key = getStorageKey(toolType);\n        sessionStorage.removeItem(key);\n        \n        // Update session metadata\n        updateSessionMetadata();\n        \n        console.log(`Measurement data cleared for ${toolType}`);\n    } catch (error) {\n        console.error('Failed to clear measurement data:', error);\n    }\n}\n\n/**\n * Clear all measurement data\n */\nexport function clearAllMeasurementData() {\n    try {\n        Object.values(STORAGE_KEYS).forEach(key => {\n            sessionStorage.removeItem(key);\n        });\n        \n        console.log('All measurement data cleared');\n    } catch (error) {\n        console.error('Failed to clear all measurement data:', error);\n    }\n}\n\n/**\n * Get the active measurement tool\n */\nexport function getActiveTool() {\n    return sessionStorage.getItem(STORAGE_KEYS.ACTIVE_TOOL) || 'google-maps';\n}\n\n/**\n * Set the active measurement tool\n */\nexport function setActiveTool(toolType) {\n    try {\n        sessionStorage.setItem(STORAGE_KEYS.ACTIVE_TOOL, toolType);\n        updateSessionMetadata();\n    } catch (error) {\n        console.error('Failed to set active tool:', error);\n    }\n}\n\n/**\n * Check if any measurement data exists\n */\nexport function hasMeasurementData() {\n    return Object.values(STORAGE_KEYS).some(key => {\n        if (key === STORAGE_KEYS.MEASUREMENT_SESSION) return false;\n        return sessionStorage.getItem(key) !== null;\n    });\n}\n\n/**\n * Get all available measurement data\n */\nexport function getAllMeasurementData() {\n    return {\n        googleMaps: getMeasurementData('google-maps'),\n        arcgis: getMeasurementData('arcgis'),\n        activeTool: getActiveTool()\n    };\n}\n\n/**\n * Get measurement summary for display\n */\nexport function getMeasurementSummary() {\n    const allData = getAllMeasurementData();\n    const summary = {\n        hasData: false,\n        tools: [],\n        totalMeasurements: 0\n    };\n    \n    if (allData.googleMaps) {\n        summary.hasData = true;\n        summary.tools.push({\n            type: 'google-maps',\n            name: 'Google Maps',\n            hasArea: !!allData.googleMaps.areaInSquareFeet,\n            area: allData.googleMaps.areaInSquareFeet || 0,\n            timestamp: allData.googleMaps.timestamp\n        });\n        summary.totalMeasurements++;\n    }\n    \n    if (allData.arcgis) {\n        summary.hasData = true;\n        const arcgisSummary = allData.arcgis.getMeasurementSummary ? \n            allData.arcgis.getMeasurementSummary() : \n            { measurementCount: { areas: 0, distances: 0 } };\n        \n        summary.tools.push({\n            type: 'arcgis',\n            name: 'ArcGIS 3D',\n            hasArea: arcgisSummary.measurementCount.areas > 0,\n            area: arcgisSummary.totalArea?.value || 0,\n            timestamp: allData.arcgis.timestamp\n        });\n        summary.totalMeasurements += arcgisSummary.measurementCount.areas + arcgisSummary.measurementCount.distances;\n    }\n    \n    return summary;\n}\n\n/**\n * Restore measurement data to a tool instance\n */\nexport function restoreMeasurementData(toolType, toolInstance) {\n    try {\n        const data = getMeasurementData(toolType);\n        if (!data) {\n            return false;\n        }\n        \n        if (toolType === 'google-maps' && toolInstance.restoreAreaData) {\n            toolInstance.restoreAreaData(data);\n            return true;\n        }\n        \n        if (toolType === 'arcgis' && toolInstance.restoreMeasurementData) {\n            toolInstance.restoreMeasurementData(data);\n            return true;\n        }\n        \n        return false;\n    } catch (error) {\n        console.error('Failed to restore measurement data:', error);\n        return false;\n    }\n}\n\n/**\n * Handle form submission - clear all measurement data\n */\nexport function handleFormSubmission() {\n    clearAllMeasurementData();\n}\n\n/**\n * Handle form reset - clear all measurement data\n */\nexport function handleFormReset() {\n    clearAllMeasurementData();\n}\n\n// Private helper functions\n\nfunction getStorageKey(toolType) {\n    switch (toolType) {\n        case 'google-maps':\n            return STORAGE_KEYS.GOOGLE_MAPS_DATA;\n        case 'arcgis':\n            return STORAGE_KEYS.ARCGIS_DATA;\n        default:\n            throw new Error(`Unknown tool type: ${toolType}`);\n    }\n}\n\nfunction updateSessionMetadata() {\n    try {\n        const metadata = {\n            lastUpdated: new Date().toISOString(),\n            tools: []\n        };\n        \n        // Check which tools have data\n        if (sessionStorage.getItem(STORAGE_KEYS.GOOGLE_MAPS_DATA)) {\n            metadata.tools.push('google-maps');\n        }\n        \n        if (sessionStorage.getItem(STORAGE_KEYS.ARCGIS_DATA)) {\n            metadata.tools.push('arcgis');\n        }\n        \n        sessionStorage.setItem(STORAGE_KEYS.MEASUREMENT_SESSION, JSON.stringify(metadata));\n    } catch (error) {\n        console.error('Failed to update session metadata:', error);\n    }\n}\n\n// Initialize storage cleanup on page load\nexport function initializeStorage() {\n    try {\n        // Clean up old sessions (older than 24 hours)\n        const sessionData = sessionStorage.getItem(STORAGE_KEYS.MEASUREMENT_SESSION);\n        if (sessionData) {\n            const parsed = JSON.parse(sessionData);\n            const sessionAge = Date.now() - new Date(parsed.lastUpdated).getTime();\n            const maxAge = 24 * 60 * 60 * 1000; // 24 hours\n            \n            if (sessionAge > maxAge) {\n                clearAllMeasurementData();\n            }\n        }\n    } catch (error) {\n        console.error('Failed to initialize storage:', error);\n    }\n}\n","/**\n * Enhanced Form Validation Service\n * Provides comprehensive validation for estimate forms with measurement tool integration\n */\n\nexport class FormValidationService {\n  constructor() {\n    this.validationRules = {\n      area: {\n        min: 50,      // Minimum 50 sq ft\n        max: 500000,  // Maximum 500,000 sq ft (11.5 acres)\n        reasonable: {\n          residential: { min: 100, max: 10000 },    // 100-10,000 sq ft\n          commercial: { min: 1000, max: 100000 },   // 1,000-100,000 sq ft\n          maintenance: { min: 50, max: 50000 },     // 50-50,000 sq ft\n          custom: { min: 50, max: 500000 },         // 50-500,000 sq ft\n          emergency: { min: 50, max: 20000 }        // 50-20,000 sq ft\n        }\n      },\n      perimeter: {\n        min: 28,      // Minimum perimeter for 50 sq ft area\n        max: 10000    // Maximum 10,000 ft perimeter\n      }\n    };\n\n    this.measurementToolInstructions = {\n      'google-maps': {\n        title: 'Google Maps Area Finder',\n        description: 'Easy-to-use 2D measurement with satellite imagery',\n        instructions: [\n          'Search for your project location using the address search',\n          'Click the drawing tools to select polygon, rectangle, or circle',\n          'Click on the map to start drawing your area',\n          'For polygons: Click to add points, click first point again to close',\n          'For rectangles: Click and drag to create the rectangle',\n          'For circles: Click center point, then drag to set radius',\n          'Use the \"Calculate Area\" button to get measurements'\n        ],\n        benefits: [\n          'Simple and intuitive interface',\n          'Real satellite imagery for accurate placement',\n          'Multiple drawing tools (polygon, rectangle, circle)',\n          'Automatic area and perimeter calculation',\n          'Address search for quick location finding'\n        ],\n        limitations: [\n          'Limited to 2D measurements only',\n          'Cannot account for elevation changes',\n          'May be less accurate for complex terrain'\n        ]\n      },\n      'arcgis-3d': {\n        title: 'ArcGIS 3D Measurement Tool',\n        description: 'Advanced 3D measurement with terrain analysis',\n        instructions: [\n          'Wait for the 3D scene to load completely',\n          'Use the navigation controls to position the view',\n          'Click the \"Area Measurement\" tool in the toolbar',\n          'Click on the terrain to start measuring',\n          'Continue clicking to add measurement points',\n          'Double-click to finish the measurement',\n          'View results in the measurement panel'\n        ],\n        benefits: [\n          'True 3D measurements with elevation data',\n          'Terrain-aware calculations for slopes and hills',\n          'More accurate for complex topography',\n          'Professional-grade measurement precision',\n          'Automatic calculation of surface area on slopes'\n        ],\n        limitations: [\n          'Requires modern browser with WebGL support',\n          'Longer loading time for 3D scene',\n          'May require more computer resources',\n          'Steeper learning curve for new users'\n        ]\n      }\n    };\n\n    this.helpText = {\n      serviceTypes: {\n        residential: 'Driveways, walkways, patios, and small parking areas for homes',\n        commercial: 'Parking lots, loading docks, and business access areas',\n        maintenance: 'Crack sealing, sealcoating, striping, and repair work',\n        custom: 'Specialized paving projects requiring unique solutions',\n        emergency: 'Urgent repairs for safety hazards or damage'\n      },\n      measurementTools: {\n        when3DRecommended: [\n          'Properties with significant elevation changes',\n          'Sloped driveways or parking areas',\n          'Terraced or multi-level projects',\n          'Properties near hills or valleys',\n          'When precise surface area is critical'\n        ],\n        when2DAcceptable: [\n          'Flat or nearly flat surfaces',\n          'Simple rectangular areas',\n          'Quick estimates for planning',\n          'Basic residential driveways',\n          'Small maintenance projects'\n        ]\n      }\n    };\n\n    this.tooltips = {\n      measurement3D: 'Use 3D measurement for slopes and complex terrain to get accurate surface area calculations. This is especially important for driveways on hills or uneven ground.',\n      areaValidation: 'Area measurements help us provide accurate estimates and ensure we bring the right equipment and materials for your project.',\n      serviceTypeSelection: 'Select the service type that best matches your project. This helps us provide appropriate pricing and timeline estimates.',\n      addressImportant: 'Project address helps us factor in local conditions, permit requirements, and travel time for accurate estimates.',\n      timeline: 'Timeline preferences help us schedule your project efficiently and set realistic expectations for completion.'\n    };\n  }\n\n  /**\n   * Validate area measurement based on service type\n   */\n  validateAreaMeasurement(area, serviceType = 'residential', unit = 'sqft') {\n    const validation = {\n      isValid: true,\n      warnings: [],\n      errors: [],\n      recommendations: []\n    };\n\n    if (!area || area <= 0) {\n      validation.isValid = false;\n      validation.errors.push('Area measurement is required and must be greater than 0');\n      return validation;\n    }\n\n    // Convert to square feet if needed\n    const areaInSqFt = this.convertToSquareFeet(area, unit);\n    \n    // Check absolute limits\n    if (areaInSqFt < this.validationRules.area.min) {\n      validation.isValid = false;\n      validation.errors.push(`Area is below minimum of ${this.validationRules.area.min} sq ft`);\n    }\n\n    if (areaInSqFt > this.validationRules.area.max) {\n      validation.isValid = false;\n      validation.errors.push(`Area exceeds maximum of ${this.validationRules.area.max.toLocaleString()} sq ft`);\n    }\n\n    // Check reasonable ranges for service type\n    const reasonableRange = this.validationRules.area.reasonable[serviceType];\n    if (reasonableRange) {\n      if (areaInSqFt < reasonableRange.min) {\n        validation.warnings.push(`Area seems small for ${serviceType} projects. Typical range is ${reasonableRange.min.toLocaleString()}-${reasonableRange.max.toLocaleString()} sq ft`);\n      }\n      \n      if (areaInSqFt > reasonableRange.max) {\n        validation.warnings.push(`Area seems large for ${serviceType} projects. Typical range is ${reasonableRange.min.toLocaleString()}-${reasonableRange.max.toLocaleString()} sq ft`);\n        validation.recommendations.push('Consider breaking large projects into phases');\n      }\n    }\n\n    // Add recommendations based on area size\n    if (areaInSqFt > 5000) {\n      validation.recommendations.push('For large areas, consider using 3D measurement tools for better accuracy');\n    }\n\n    if (areaInSqFt > 20000) {\n      validation.recommendations.push('Large commercial projects may require site survey for final measurements');\n    }\n\n    return validation;\n  }\n\n  /**\n   * Validate perimeter measurement\n   */\n  validatePerimeterMeasurement(perimeter, area, unit = 'ft') {\n    const validation = {\n      isValid: true,\n      warnings: [],\n      errors: []\n    };\n\n    if (!perimeter || perimeter <= 0) {\n      validation.warnings.push('Perimeter measurement not provided - using area-based estimate');\n      return validation;\n    }\n\n    // Convert to feet if needed\n    const perimeterInFt = this.convertToFeet(perimeter, unit);\n    \n    // Check absolute limits\n    if (perimeterInFt < this.validationRules.perimeter.min) {\n      validation.warnings.push(`Perimeter seems unusually small (${perimeterInFt} ft)`);\n    }\n\n    if (perimeterInFt > this.validationRules.perimeter.max) {\n      validation.warnings.push(`Perimeter seems unusually large (${perimeterInFt.toLocaleString()} ft)`);\n    }\n\n    // Check perimeter-to-area ratio for reasonableness\n    if (area) {\n      const areaInSqFt = this.convertToSquareFeet(area, unit === 'ft' ? 'sqft' : 'sqm');\n      const ratio = perimeterInFt / Math.sqrt(areaInSqFt);\n      \n      if (ratio > 8) {\n        validation.warnings.push('Area shape appears very elongated or irregular');\n      }\n      \n      if (ratio < 2) {\n        validation.warnings.push('Area shape appears very compact - please verify measurements');\n      }\n    }\n\n    return validation;\n  }\n\n  /**\n   * Get measurement tool instructions for specific tool\n   */\n  getMeasurementToolInstructions(toolType) {\n    return this.measurementToolInstructions[toolType] || null;\n  }\n\n  /**\n   * Get help text for specific form field\n   */\n  getHelpText(fieldType, subType = null) {\n    if (subType && this.helpText[fieldType] && this.helpText[fieldType][subType]) {\n      return this.helpText[fieldType][subType];\n    }\n    return this.helpText[fieldType] || null;\n  }\n\n  /**\n   * Get tooltip text for specific element\n   */\n  getTooltip(elementType) {\n    return this.tooltips[elementType] || null;\n  }\n\n  /**\n   * Recommend measurement tool based on project characteristics\n   */\n  recommendMeasurementTool(serviceType, projectDescription = '', hasSlope = false) {\n    const recommendation = {\n      primary: 'google-maps',\n      secondary: 'arcgis-3d',\n      reasoning: []\n    };\n\n    // Check for slope indicators\n    const slopeKeywords = ['slope', 'hill', 'sloped', 'steep', 'elevation', 'grade', 'incline'];\n    const hasSlopeKeyword = slopeKeywords.some(keyword => \n      projectDescription.toLowerCase().includes(keyword)\n    );\n\n    if (hasSlope || hasSlopeKeyword) {\n      recommendation.primary = 'arcgis-3d';\n      recommendation.secondary = 'google-maps';\n      recommendation.reasoning.push('3D measurement recommended for sloped terrain');\n    }\n\n    // Commercial projects often benefit from 3D measurement\n    if (serviceType === 'commercial') {\n      recommendation.reasoning.push('Commercial projects benefit from precise 3D measurements');\n      if (recommendation.primary === 'google-maps') {\n        recommendation.reasoning.push('Consider 3D measurement for complex layouts');\n      }\n    }\n\n    // Emergency repairs usually need quick 2D measurement\n    if (serviceType === 'emergency') {\n      recommendation.primary = 'google-maps';\n      recommendation.secondary = 'arcgis-3d';\n      recommendation.reasoning.push('Quick 2D measurement suitable for emergency repairs');\n    }\n\n    return recommendation;\n  }\n\n  /**\n   * Validate complete form data\n   */\n  validateForm(formData) {\n    const validation = {\n      isValid: true,\n      errors: [],\n      warnings: [],\n      recommendations: []\n    };\n\n    // Validate required fields\n    const requiredFields = ['firstName', 'lastName', 'email', 'phone', 'serviceType'];\n    requiredFields.forEach(field => {\n      if (!formData[field] || formData[field].trim() === '') {\n        validation.isValid = false;\n        validation.errors.push(`${this.formatFieldName(field)} is required`);\n      }\n    });\n\n    // Validate email format\n    if (formData.email && !this.isValidEmail(formData.email)) {\n      validation.isValid = false;\n      validation.errors.push('Please enter a valid email address');\n    }\n\n    // Validate phone format\n    if (formData.phone && !this.isValidPhone(formData.phone)) {\n      validation.warnings.push('Phone number format could not be verified');\n    }\n\n    // Validate area measurement if provided\n    if (formData.areaData) {\n      const areaValidation = this.validateAreaMeasurement(\n        formData.areaData.area || formData.areaData.areaInSquareFeet,\n        formData.serviceType,\n        'sqft'\n      );\n      \n      validation.isValid = validation.isValid && areaValidation.isValid;\n      validation.errors.push(...areaValidation.errors);\n      validation.warnings.push(...areaValidation.warnings);\n      validation.recommendations.push(...areaValidation.recommendations);\n\n      // Validate perimeter if provided\n      if (formData.areaData.perimeter) {\n        const perimeterValidation = this.validatePerimeterMeasurement(\n          formData.areaData.perimeter,\n          formData.areaData.area || formData.areaData.areaInSquareFeet,\n          'ft'\n        );\n        validation.warnings.push(...perimeterValidation.warnings);\n        validation.errors.push(...perimeterValidation.errors);\n      }\n    }\n\n    // Add measurement tool recommendation\n    const toolRecommendation = this.recommendMeasurementTool(\n      formData.serviceType,\n      formData.projectDescription\n    );\n    validation.recommendations.push(...toolRecommendation.reasoning);\n\n    return validation;\n  }\n\n  /**\n   * Get validation message for display\n   */\n  getValidationMessage(validation) {\n    let message = '';\n    \n    if (validation.errors.length > 0) {\n      message += `Errors: ${validation.errors.join(', ')}\\n`;\n    }\n    \n    if (validation.warnings.length > 0) {\n      message += `Warnings: ${validation.warnings.join(', ')}\\n`;\n    }\n    \n    if (validation.recommendations.length > 0) {\n      message += `Recommendations: ${validation.recommendations.join(', ')}`;\n    }\n    \n    return message.trim();\n  }\n\n  // Helper methods\n  convertToSquareFeet(value, unit) {\n    const conversions = {\n      sqft: 1,\n      sqm: 10.7639,\n      acres: 43560\n    };\n    return value * (conversions[unit] || 1);\n  }\n\n  convertToFeet(value, unit) {\n    const conversions = {\n      ft: 1,\n      m: 3.28084,\n      meters: 3.28084\n    };\n    return value * (conversions[unit] || 1);\n  }\n\n  formatFieldName(fieldName) {\n    return fieldName.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase());\n  }\n\n  isValidEmail(email) {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(email);\n  }\n\n  isValidPhone(phone) {\n    const phoneRegex = /^[\\+]?[1-9][\\d]{0,15}$/;\n    const cleanPhone = phone.replace(/\\D/g, '');\n    return cleanPhone.length >= 10 && phoneRegex.test(cleanPhone);\n  }\n}\n\nexport default FormValidationService;\n","export class EstimateService {\n  constructor() {\n    this.rates = {\n      residential: {\n        base: 3.50,\n        premium: 4.50\n      },\n      commercial: {\n        base: 4.00,\n        premium: 5.00\n      }\n    };\n\n    // Pricing modifiers\n    this.modifiers = {\n      complexity: {\n        simple: 1.0,\n        moderate: 1.2,\n        complex: 1.5\n      },\n      accessibility: {\n        easy: 1.0,\n        moderate: 1.15,\n        difficult: 1.3\n      },\n      season: {\n        peak: 1.1,\n        regular: 1.0,\n        offSeason: 0.9\n      },\n      urgency: {\n        standard: 1.0,\n        rush: 1.25,\n        emergency: 1.5\n      }\n    };\n\n    // Material costs per square foot\n    this.materialCosts = {\n      asphalt: 2.50,\n      concrete: 4.00,\n      sealcoating: 0.50,\n      striping: 0.25\n    };\n\n    // Labor rates (per hour)\n    this.laborRates = {\n      skilled: 45.00,\n      semiskilled: 35.00,\n      general: 25.00\n    };\n  }\n\n  calculateEstimate(squareFeet, serviceType, options = {}) {\n    const estimate = {\n      baseCost: 0,\n      materialCost: 0,\n      laborCost: 0,\n      totalCost: 0,\n      timeline: {\n        days: 0,\n        startDate: null,\n        endDate: null\n      },\n      breakdown: {}\n    };\n\n    // Base cost calculation\n    const { base, premium } = this.rates[serviceType];\n    estimate.baseCost = squareFeet * (options.premium ? premium : base);\n\n    // Apply pricing modifiers\n    let modifiedCost = estimate.baseCost;\n    if (options.complexity) {\n      modifiedCost *= this.modifiers.complexity[options.complexity] || 1.0;\n    }\n    if (options.accessibility) {\n      modifiedCost *= this.modifiers.accessibility[options.accessibility] || 1.0;\n    }\n    if (options.season) {\n      modifiedCost *= this.modifiers.season[options.season] || 1.0;\n    }\n    if (options.urgency) {\n      modifiedCost *= this.modifiers.urgency[options.urgency] || 1.0;\n    }\n\n    // Apply discount if provided\n    if (options.discount && options.discount > 0 && options.discount < 1) {\n      modifiedCost *= (1 - options.discount);\n    }\n\n    estimate.baseCost = modifiedCost;\n\n    // Material cost calculation\n    estimate.materialCost = this.calculateMaterialCost(squareFeet, options.materials || []);\n\n    // Labor cost estimation\n    estimate.laborCost = this.calculateLaborCost(squareFeet, serviceType, options);\n\n    // Project timeline estimation\n    estimate.timeline = this.calculateTimeline(squareFeet, serviceType, options);\n\n    // Total cost\n    estimate.totalCost = estimate.baseCost + estimate.materialCost + estimate.laborCost;\n\n    // Breakdown for transparency\n    estimate.breakdown = {\n      baseRate: options.premium ? premium : base,\n      squareFeet: squareFeet,\n      modifiers: this.getAppliedModifiers(options),\n      materials: options.materials || [],\n      laborHours: this.calculateLaborHours(squareFeet, serviceType, options)\n    };\n\n    return estimate;\n  }\n\n  calculateMaterialCost(squareFeet, materials) {\n    let totalMaterialCost = 0;\n\n    materials.forEach(material => {\n      const costPerSqFt = this.materialCosts[material.type] || 0;\n      const coverage = material.coverage || squareFeet;\n      const quantity = material.quantity || 1;\n      \n      totalMaterialCost += costPerSqFt * coverage * quantity;\n    });\n\n    return totalMaterialCost;\n  }\n\n  calculateLaborCost(squareFeet, serviceType, options) {\n    const laborHours = this.calculateLaborHours(squareFeet, serviceType, options);\n    const skillLevel = options.skillLevel || 'semiskilled';\n    const hourlyRate = this.laborRates[skillLevel] || this.laborRates.semiskilled;\n\n    return laborHours * hourlyRate;\n  }\n\n  calculateLaborHours(squareFeet, serviceType, options) {\n    // Base hours per square foot based on service type\n    const baseHoursPerSqFt = {\n      residential: 0.02,\n      commercial: 0.015\n    };\n\n    let hours = squareFeet * (baseHoursPerSqFt[serviceType] || 0.02);\n\n    // Adjust for complexity\n    if (options.complexity === 'complex') {\n      hours *= 1.5;\n    } else if (options.complexity === 'moderate') {\n      hours *= 1.2;\n    }\n\n    // Adjust for accessibility\n    if (options.accessibility === 'difficult') {\n      hours *= 1.3;\n    } else if (options.accessibility === 'moderate') {\n      hours *= 1.15;\n    }\n\n    // Minimum hours for small jobs\n    return Math.max(hours, 4);\n  }\n\n  calculateTimeline(squareFeet, serviceType, options) {\n    const laborHours = this.calculateLaborHours(squareFeet, serviceType, options);\n    const hoursPerDay = options.hoursPerDay || 8;\n    const workDays = Math.ceil(laborHours / hoursPerDay);\n\n    // Add buffer days for weather, permits, etc.\n    const bufferDays = Math.ceil(workDays * 0.2);\n    const totalDays = workDays + bufferDays;\n\n    const startDate = options.startDate ? new Date(options.startDate) : new Date();\n    const endDate = new Date(startDate);\n    endDate.setDate(startDate.getDate() + totalDays);\n\n    return {\n      days: totalDays,\n      workDays: workDays,\n      bufferDays: bufferDays,\n      startDate: startDate.toISOString().split('T')[0],\n      endDate: endDate.toISOString().split('T')[0]\n    };\n  }\n\n  getAppliedModifiers(options) {\n    const applied = {};\n    \n    if (options.complexity) {\n      applied.complexity = {\n        type: options.complexity,\n        multiplier: this.modifiers.complexity[options.complexity]\n      };\n    }\n    if (options.accessibility) {\n      applied.accessibility = {\n        type: options.accessibility,\n        multiplier: this.modifiers.accessibility[options.accessibility]\n      };\n    }\n    if (options.season) {\n      applied.season = {\n        type: options.season,\n        multiplier: this.modifiers.season[options.season]\n      };\n    }\n    if (options.urgency) {\n      applied.urgency = {\n        type: options.urgency,\n        multiplier: this.modifiers.urgency[options.urgency]\n      };\n    }\n    if (options.discount) {\n      applied.discount = {\n        rate: options.discount,\n        multiplier: (1 - options.discount)\n      };\n    }\n\n    return applied;\n  }\n\n  // Utility method to get available options\n  getAvailableOptions() {\n    return {\n      serviceTypes: Object.keys(this.rates),\n      complexityLevels: Object.keys(this.modifiers.complexity),\n      accessibilityLevels: Object.keys(this.modifiers.accessibility),\n      seasons: Object.keys(this.modifiers.season),\n      urgencyLevels: Object.keys(this.modifiers.urgency),\n      materialTypes: Object.keys(this.materialCosts),\n      skillLevels: Object.keys(this.laborRates)\n    };\n  }\n}\n\n","/**\n * Estimate Form Component\n * Comprehensive form with measurement tool integration and validation\n */\n\nimport { FormValidationService } from '../services/form-validation-service.js';\nimport { EstimateService } from '../services/estimate-service.js';\nimport { getMeasurementData, getAllMeasurementData, hasMeasurementData } from '../utils/measurement-storage.js';\n\nexport class EstimateForm {\n    constructor(containerId) {\n        this.container = document.getElementById(containerId);\n        this.validationService = new FormValidationService();\n        this.estimateService = new EstimateService();\n        this.formData = {};\n    this.measurementData = null;\n    this.serviceType = document.getElementById('service-type');\n    this.squareFootage = document.getElementById('square-footage');\n        this.isSubmitting = false;\n        \n        this.init();\n    }\n\n    init() {\n        this.render();\nthis.attachEventListeners();\nthis.formatPricingDisplay();\n        this.loadMeasurementData();\nthis.updateSubmitButtonState();\nthis.calculatePricing();\n    }\n\n    render() {\n        this.container.innerHTML = `\n            <div class=\"estimate-form-container\">\n                <div class=\"form-header\">\n                    <h2>Request Your Free Estimate</h2>\n                    <p class=\"form-subtitle\">Complete the form below to receive a detailed estimate for your paving project</p>\n                </div>\n\n                <form id=\"estimate-form\" class=\"estimate-form\" novalidate>\n                    <!-- Personal Information Section -->\n                    <div class=\"form-section\">\n                        <h3 class=\"section-title\">\n                            <span class=\"section-icon\"></span>\n                            Personal Information\n                        </h3>\n                        \n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"firstName\" class=\"form-label\">\n                                    First Name <span class=\"required\">*</span>\n                                </label>\n                                <input \n                                    type=\"text\" \n                                    id=\"firstName\" \n                                    name=\"firstName\" \n                                    class=\"form-input\" \n                                    required\n                                    aria-describedby=\"firstName-error\"\n                                >\n                                <div class=\"error-message\" id=\"firstName-error\"></div>\n                            </div>\n                            \n                            <div class=\"form-group\">\n                                <label for=\"lastName\" class=\"form-label\">\n                                    Last Name <span class=\"required\">*</span>\n                                </label>\n                                <input \n                                    type=\"text\" \n                                    id=\"lastName\" \n                                    name=\"lastName\" \n                                    class=\"form-input\" \n                                    required\n                                    aria-describedby=\"lastName-error\"\n                                >\n                                <div class=\"error-message\" id=\"lastName-error\"></div>\n                            </div>\n                        </div>\n\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"email\" class=\"form-label\">\n                                    Email Address <span class=\"required\">*</span>\n                                </label>\n                                <input \n                                    type=\"email\" \n                                    id=\"email\" \n                                    name=\"email\" \n                                    class=\"form-input\" \n                                    required\n                                    aria-describedby=\"email-error\"\n                                    placeholder=\"your@email.com\"\n                                >\n                                <div class=\"error-message\" id=\"email-error\"></div>\n                            </div>\n                            \n                            <div class=\"form-group\">\n                                <label for=\"phone\" class=\"form-label\">\n                                    Phone Number <span class=\"required\">*</span>\n                                </label>\n                                <input \n                                    type=\"tel\" \n                                    id=\"phone\" \n                                    name=\"phone\" \n                                    class=\"form-input\" \n                                    required\n                                    aria-describedby=\"phone-error\"\n                                    placeholder=\"(555) 123-4567\"\n                                >\n                                <div class=\"error-message\" id=\"phone-error\"></div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- Project Details Section -->\n                    <div class=\"form-section\">\n                        <h3 class=\"section-title\">\n                            <span class=\"section-icon\"></span>\n                            Project Details\n                        </h3>\n                        \n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"serviceType\" class=\"form-label\">\n                                    Service Type <span class=\"required\">*</span>\n                                    <span class=\"tooltip\" data-tooltip=\"${this.validationService.getTooltip('serviceTypeSelection')}\"></span>\n                                </label>\n                                <select \n                                    id=\"serviceType\" \n                                    name=\"serviceType\" \n                                    class=\"form-select\" \n                                    required\n                                    aria-describedby=\"serviceType-error\"\n                                >\n                                    <option value=\"\">Select a service type</option>\n                                    <option value=\"residential\">Residential Paving</option>\n                                    <option value=\"commercial\">Commercial Paving</option>\n                                    <option value=\"maintenance\">Maintenance Services</option>\n                                    <option value=\"custom\">Custom Projects</option>\n                                    <option value=\"emergency\">Emergency Repairs</option>\n                                </select>\n                                <div class=\"error-message\" id=\"serviceType-error\"></div>\n                                <div class=\"help-text\" id=\"serviceType-help\"></div>\n                            </div>\n                            \n                            <div class=\"form-group\">\n                                <label for=\"timeline\" class=\"form-label\">\n                                    Preferred Timeline\n                                    <span class=\"tooltip\" data-tooltip=\"${this.validationService.getTooltip('timeline')}\"></span>\n                                </label>\n                                <input \n                                    type=\"date\" \n                                    id=\"timeline\" \n                                    name=\"timeline\" \n                                    class=\"form-input\"\n                                    min=\"${new Date().toISOString().split('T')[0]}\"\n                                    aria-describedby=\"timeline-error\"\n                                >\n                                <div class=\"error-message\" id=\"timeline-error\"></div>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"projectDescription\" class=\"form-label\">\n                                Project Description\n                            </label>\n                            <textarea \n                                id=\"projectDescription\" \n                                name=\"projectDescription\" \n                                class=\"form-textarea\" \n                                rows=\"4\"\n                                placeholder=\"Please describe your paving project in detail...\"\n                                aria-describedby=\"projectDescription-error\"\n                            ></textarea>\n                            <div class=\"error-message\" id=\"projectDescription-error\"></div>\n                        </div>\n                    </div>\n\n                    <!-- Property Address Section -->\n                    <div class=\"form-section\">\n                        <h3 class=\"section-title\">\n                            <span class=\"section-icon\"></span>\n                            Property Address\n                            <span class=\"tooltip\" data-tooltip=\"${this.validationService.getTooltip('addressImportant')}\"></span>\n                        </h3>\n                        \n                        <div class=\"form-group\">\n                            <label for=\"streetAddress\" class=\"form-label\">\n                                Street Address <span class=\"required\">*</span>\n                            </label>\n                            <input \n                                type=\"text\" \n                                id=\"streetAddress\" \n                                name=\"streetAddress\" \n                                class=\"form-input\" \n                                required\n                                placeholder=\"123 Main Street\"\n                                aria-describedby=\"streetAddress-error\"\n                            >\n                            <div class=\"error-message\" id=\"streetAddress-error\"></div>\n                        </div>\n\n                        <div class=\"form-row\">\n                            <div class=\"form-group\">\n                                <label for=\"city\" class=\"form-label\">\n                                    City <span class=\"required\">*</span>\n                                </label>\n                                <input \n                                    type=\"text\" \n                                    id=\"city\" \n                                    name=\"city\" \n                                    class=\"form-input\" \n                                    required\n                                    aria-describedby=\"city-error\"\n                                >\n                                <div class=\"error-message\" id=\"city-error\"></div>\n                            </div>\n                            \n                            <div class=\"form-group\">\n                                <label for=\"state\" class=\"form-label\">\n                                    State <span class=\"required\">*</span>\n                                </label>\n                                <select \n                                    id=\"state\" \n                                    name=\"state\" \n                                    class=\"form-select\" \n                                    required\n                                    aria-describedby=\"state-error\"\n                                >\n                                    <option value=\"\">Select State</option>\n                                    <option value=\"OH\">Ohio</option>\n                                    <option value=\"KY\">Kentucky</option>\n                                    <option value=\"WV\">West Virginia</option>\n                                    <option value=\"PA\">Pennsylvania</option>\n                                    <option value=\"IN\">Indiana</option>\n                                    <option value=\"MI\">Michigan</option>\n                                </select>\n                                <div class=\"error-message\" id=\"state-error\"></div>\n                            </div>\n                            \n                            <div class=\"form-group\">\n                                <label for=\"zipCode\" class=\"form-label\">\n                                    ZIP Code <span class=\"required\">*</span>\n                                </label>\n                                <input \n                                    type=\"text\" \n                                    id=\"zipCode\" \n                                    name=\"zipCode\" \n                                    class=\"form-input\" \n                                    required\n                                    pattern=\"[0-9]{5}(-[0-9]{4})?\"\n                                    placeholder=\"12345\"\n                                    aria-describedby=\"zipCode-error\"\n                                >\n                                <div class=\"error-message\" id=\"zipCode-error\"></div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- Map Measurement Data Section -->\n                    <div class=\"form-section\">\n                        <h3 class=\"section-title\">\n                            <span class=\"section-icon\"></span>\n                            Area Measurement\n                            <span class=\"tooltip\" data-tooltip=\"${this.validationService.getTooltip('areaValidation')}\"></span>\n                        </h3>\n                        \n                        <div class=\"measurement-status\" id=\"measurement-status\">\n                            <div class=\"measurement-requirement\">\n                                <strong>Use the map below to measure your project area</strong>\n                                <p>Draw the area on the map to get an accurate measurement for your estimate.</p>\n                            </div>\n                        </div>\n\n                        <!-- Map Container -->\n                        <div class=\"map-container\">\n                            <!-- Tool Selection -->\n                            <div class=\"tool-selection\">\n                                <button type=\"button\" class=\"toggle-btn active\" data-tool=\"arcgis-3d\" id=\"arcgis-toggle\">\n                                     ArcGIS 3D Measurement\n                                </button>\n                                <button type=\"button\" class=\"toggle-btn\" data-tool=\"google-maps\" id=\"google-maps-toggle\">\n                                     Google Maps Measurement\n                                </button>\n                            </div>\n\n                            <!-- ArcGIS Container (Default/Active) -->\n                            <div id=\"arcgis-container\" class=\"map-placeholder\" style=\"display: block;\">\n                                <div id=\"arcgis-scene-view\" style=\"height: 400px; width: 100%; position: relative;\">\n                                    <div id=\"arcgis-placeholder\" style=\"display: flex; align-items: center; justify-content: center; height: 100%; background: #f5f5f5; border-radius: 8px; flex-direction: column; gap: 1rem;\">\n                                        <div class=\"loading-spinner\" style=\"width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #ffd700; border-radius: 50%; animation: spin 1s linear infinite;\"></div>\n                                        <p style=\"color: #6b6b6b; font-size: 16px; margin: 0;\">Loading ArcGIS 3D scene...</p>\n                                    </div>\n                                </div>\n                                <div id=\"arcgis-results\" class=\"measurement-results\" style=\"display: none; margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;\">\n                                    <h4 style=\"margin: 0 0 0.5rem 0; color: #2c2c2c; font-size: 18px;\">Measurement Results</h4>\n                                    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;\">\n                                        <div class=\"result-item\">\n                                            <span style=\"font-weight: 600; color: #495057;\">Line Measurement:</span>\n                                            <span id=\"line-result\" style=\"color: #007bff; font-weight: 600;\">0 m</span>\n                                        </div>\n                                        <div class=\"result-item\">\n                                            <span style=\"font-weight: 600; color: #495057;\">Area Measurement:</span>\n                                            <span id=\"area-result\" style=\"color: #28a745; font-weight: 600;\">0 m</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <!-- Google Maps Container (Hidden by default) -->\n                            <div id=\"google-maps-container\" class=\"map-placeholder\" style=\"display: none;\">\n                                <div id=\"google-maps-measurement\" style=\"height: 400px; width: 100%; position: relative;\">\n                                    <p style=\"text-align: center; padding: 2rem; color: #6b6b6b;\">Google Maps measurement tool will load here</p>\n                                </div>\n                                <div id=\"google-maps-results\" class=\"measurement-results\" style=\"display: none; margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;\">\n                                    <h4 style=\"margin: 0 0 0.5rem 0; color: #2c2c2c; font-size: 18px;\">Measurement Results</h4>\n                                    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;\">\n                                        <div class=\"result-item\">\n                                            <span style=\"font-weight: 600; color: #495057;\">Area:</span>\n                                            <span id=\"google-area-result\" style=\"color: #28a745; font-weight: 600;\">0 sq ft</span>\n                                        </div>\n                                        <div class=\"result-item\">\n                                            <span style=\"font-weight: 600; color: #495057;\">Perimeter:</span>\n                                            <span id=\"google-perimeter-result\" style=\"color: #007bff; font-weight: 600;\">0 ft</span>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n\n                        <!-- Hidden fields for measurement data -->\n                        <input type=\"hidden\" id=\"areaCoordinates\" name=\"areaCoordinates\">\n                        <input type=\"hidden\" id=\"calculatedSquareFootage\" name=\"calculatedSquareFootage\">\n                        <input type=\"hidden\" id=\"measurementTool\" name=\"measurementTool\">\n                        <input type=\"hidden\" id=\"measurementTimestamp\" name=\"measurementTimestamp\">\n                    </div>\n\n                    <!-- Form Actions -->\n                    <div class=\"form-actions\">\n                        <button type=\"button\" class=\"btn btn-outline\" id=\"reset-form\">\n                            Reset Form\n                        </button>\n                        <button type=\"submit\" class=\"btn btn-primary\" id=\"submit-estimate\" disabled>\n                            <span class=\"btn-text\">Request Estimate</span>\n                            <span class=\"btn-loading\" style=\"display: none;\">\n                                <span class=\"spinner\"></span> Processing...\n                            </span>\n                        </button>\n                        <button type=\"button\" class=\"btn btn-secondary\" id=\"get-quote\" disabled style=\"margin-left: 1rem;\">\n                            <span class=\"btn-text\">Get Quick Quote</span>\n                            <span class=\"btn-loading\" style=\"display: none;\">\n                                <span class=\"spinner\"></span> Calculating...\n                            </span>\n                        </button>\n                    </div>\n                    \n                    <!-- Pricing Display Section -->\n                    <div class=\"pricing-display\" id=\"pricing-display\" style=\"display: none;\">\n                        <div class=\"pricing-header\">\n                            <h3>Estimated Pricing</h3>\n                            <p class=\"pricing-disclaimer\">*This is an estimate. Final pricing may vary based on site conditions and additional requirements.</p>\n                        </div>\n                        <div class=\"pricing-details\" id=\"pricing-details\">\n                            <!-- Pricing information will be populated here -->\n                        </div>\n                    </div>\n\n                    <!-- Form Validation Summary -->\n                    <div class=\"validation-summary\" id=\"validation-summary\" style=\"display: none;\">\n                        <h4>Please correct the following errors:</h4>\n                        <ul id=\"validation-errors\"></ul>\n                    </div>\n                </form>\n            </div>\n        `;\n    }\n\n    attachEventListeners() {\n        const form = document.getElementById('estimate-form');\n        const submitButton = document.getElementById('submit-estimate');\n        const getQuoteButton = document.getElementById('get-quote');\n        const resetButton = document.getElementById('reset-form');\n        const serviceTypeSelect = document.getElementById('serviceType');\n        const arcgisToggle = document.getElementById('arcgis-toggle');\n        const googleMapsToggle = document.getElementById('google-maps-toggle');\n\n        // Form submission\n        form.addEventListener('submit', (e) => this.handleSubmit(e));\n\n        // Get quote button\n        if (getQuoteButton) {\n            getQuoteButton.addEventListener('click', () => this.handleGetQuote());\n        }\n\n        // Reset form\n        resetButton.addEventListener('click', () => this.resetForm());\n\n        // Service type change\n        serviceTypeSelect.addEventListener('change', (e) => this.handleServiceTypeChange(e));\n\n        // Real-time validation\n        form.addEventListener('input', (e) => this.handleFieldValidation(e));\n        form.addEventListener('blur', (e) => this.handleFieldValidation(e), true);\n\n        // Measurement tool toggle buttons\n        if (arcgisToggle) {\n            arcgisToggle.addEventListener('click', () => this.toggleMeasurementTool('arcgis-3d'));\n        }\n        if (googleMapsToggle) {\n            googleMapsToggle.addEventListener('click', () => this.toggleMeasurementTool('google-maps'));\n        }\n\n        // Phone number formatting\n        const phoneInput = document.getElementById('phone');\n        phoneInput.addEventListener('input', (e) => this.formatPhoneNumber(e));\n        \n        // Initialize measurement tools after form is rendered\n        setTimeout(() => this.initializeMeasurementTools(), 100);\n    }\n\n    handleSubmit(event) {\n        event.preventDefault();\n        \n        if (this.isSubmitting) return;\n\n        this.isSubmitting = true;\n        this.updateSubmitButtonState(true);\n\n        // Collect form data\n        const formData = new FormData(event.target);\n        const data = Object.fromEntries(formData.entries());\n\n        // Add measurement data\n        if (this.measurementData) {\n            data.areaData = this.measurementData;\n        }\n\n        // Validate form\n        const validation = this.validationService.validateForm(data);\n        \n        if (!validation.isValid) {\n            this.displayValidationErrors(validation);\n            this.isSubmitting = false;\n            this.updateSubmitButtonState(false);\n            return;\n        }\n\n        // Submit form\n        this.submitForm(data);\n    }\n\n    async submitForm(data) {\n        try {\n            // Generate estimate\n            const estimate = this.estimateService.calculateEstimate(\n                data.areaData?.areaInSquareFeet || 0,\n                data.serviceType,\n                {\n                    premium: false,\n                    complexity: 'moderate',\n                    accessibility: 'easy',\n                    season: 'regular',\n                    urgency: 'standard'\n                }\n            );\n\n            // Prepare submission data\n            const submissionData = {\n                ...data,\n                estimate,\n                submittedAt: new Date().toISOString()\n            };\n\n            // Submit to backend\n            const response = await fetch('/api/estimates', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(submissionData)\n            });\n\n            if (!response.ok) {\n                throw new Error('Failed to submit estimate request');\n            }\n\n            const result = await response.json();\n            this.handleSubmitSuccess(result);\n\n        } catch (error) {\n            this.handleSubmitError(error);\n        } finally {\n            this.isSubmitting = false;\n            this.updateSubmitButtonState(false);\n        }\n    }\n\n    handleSubmitSuccess(result) {\n        // Show success message\n        this.container.innerHTML = `\n            <div class=\"success-message\">\n                <div class=\"success-icon\"></div>\n                <h2>Estimate Request Submitted Successfully!</h2>\n                <p>Thank you for your interest in our paving services. We've received your request and will contact you within 2 hours.</p>\n                <div class=\"success-details\">\n                    <p><strong>Reference #:</strong> ${result.referenceNumber}</p>\n                    <p><strong>Estimated Project Cost:</strong> $${result.estimate?.totalCost?.toLocaleString() || 'TBD'}</p>\n                </div>\n                <button type=\"button\" class=\"btn btn-primary\" onclick=\"window.location.reload()\">\n                    Submit Another Request\n                </button>\n            </div>\n        `;\n\n        // Clear measurement data\n        import('../utils/measurement-storage.js').then(({ handleFormSubmission }) => {\n            handleFormSubmission();\n        });\n    }\n\n    handleSubmitError(error) {\n        console.error('Form submission error:', error);\n        \n        const errorDiv = document.createElement('div');\n        errorDiv.className = 'error-alert';\n        errorDiv.innerHTML = `\n            <strong>Error:</strong> ${error.message}\n            <button type=\"button\" class=\"error-close\" onclick=\"this.parentElement.remove()\"></button>\n        `;\n        \n        this.container.insertBefore(errorDiv, this.container.firstChild);\n    }\n\n    handleFieldValidation(event) {\n        const field = event.target;\n        const fieldName = field.name;\n        const value = field.value;\n\n        if (!fieldName) return;\n\n        // Clear previous error\n        const errorElement = document.getElementById(`${fieldName}-error`);\n        if (errorElement) {\n            errorElement.textContent = '';\n            field.classList.remove('error');\n        }\n\n        // Basic validation\n        if (field.hasAttribute('required') && !value.trim()) {\n            if (event.type === 'blur') {\n                this.showFieldError(field, 'This field is required');\n            }\n            return;\n        }\n\n        // Field-specific validation\n        switch (fieldName) {\n            case 'email':\n                if (value && !this.validationService.isValidEmail(value)) {\n                    this.showFieldError(field, 'Please enter a valid email address');\n                }\n                break;\n            case 'phone':\n                if (value && !this.validationService.isValidPhone(value)) {\n                    this.showFieldError(field, 'Please enter a valid phone number');\n                }\n                break;\n            case 'zipCode':\n                if (value && !/^\\d{5}(-\\d{4})?$/.test(value)) {\n                    this.showFieldError(field, 'Please enter a valid ZIP code');\n                }\n                break;\n        }\n\n        // Update submit button state\n        this.updateSubmitButtonState();\n    }\n\n    showFieldError(field, message) {\n        const errorElement = document.getElementById(`${field.name}-error`);\n        if (errorElement) {\n            errorElement.textContent = message;\n            field.classList.add('error');\n        }\n    }\n\n    displayValidationErrors(validation) {\n        const summaryDiv = document.getElementById('validation-summary');\n        const errorsList = document.getElementById('validation-errors');\n\n        if (validation.errors.length > 0) {\n            errorsList.innerHTML = validation.errors.map(error => `<li>${error}</li>`).join('');\n            summaryDiv.style.display = 'block';\n            summaryDiv.scrollIntoView({ behavior: 'smooth' });\n        }\n    }\n\n    handleServiceTypeChange(event) {\n        const serviceType = event.target.value;\n        const helpText = document.getElementById('serviceType-help');\n        \n        if (serviceType && this.validationService.getHelpText('serviceTypes', serviceType)) {\n            helpText.textContent = this.validationService.getHelpText('serviceTypes', serviceType);\n            helpText.style.display = 'block';\n        } else {\n            helpText.style.display = 'none';\n        }\n    }\n\n    formatPhoneNumber(event) {\n        let value = event.target.value.replace(/\\D/g, '');\n        \n        if (value.length >= 6) {\n            value = value.replace(/(\\d{3})(\\d{3})(\\d{4})/, '($1) $2-$3');\n        } else if (value.length >= 3) {\n            value = value.replace(/(\\d{3})(\\d{3})/, '($1) $2');\n        } else if (value.length > 0) {\n            value = value.replace(/(\\d{3})/, '($1');\n        }\n        \n        event.target.value = value;\n    }\n\n    launchMeasurementTool(toolType) {\n        // This would integrate with the existing measurement tools\n        window.open(`/assets/measurement-tools/${toolType}.html`, '_blank');\n    }\n\n    loadMeasurementData() {\n        if (hasMeasurementData()) {\n            this.measurementData = getAllMeasurementData();\n            this.updateMeasurementStatus();\n        }\n    }\n\n    updateMeasurementStatus() {\n        const statusDiv = document.getElementById('measurement-status');\n        \n        if (this.measurementData && (this.measurementData.googleMaps || this.measurementData.arcgis)) {\n            const data = this.measurementData.googleMaps || this.measurementData.arcgis;\n            const area = data.areaInSquareFeet || data.area || 0;\n            \n            statusDiv.innerHTML = `\n                <div class=\"measurement-success\">\n                    <strong> Area Measured: ${area.toLocaleString()} sq ft</strong>\n                    <p>Using ${this.measurementData.activeTool === 'google-maps' ? 'Google Maps' : 'ArcGIS 3D'} tool</p>\n                </div>\n            `;\n\n            // Update hidden fields\n            document.getElementById('calculatedSquareFootage').value = area;\n            document.getElementById('measurementTool').value = this.measurementData.activeTool;\n            document.getElementById('measurementTimestamp').value = new Date().toISOString();\n        }\n    }\n\n    updateSubmitButtonState(isLoading = false) {\n        const submitButton = document.getElementById('submit-estimate');\n        const getQuoteButton = document.getElementById('get-quote');\n        const btnText = submitButton.querySelector('.btn-text');\n        const btnLoading = submitButton.querySelector('.btn-loading');\n        const getQuoteText = getQuoteButton.querySelector('.btn-text');\n        const getQuoteLoading = getQuoteButton.querySelector('.btn-loading');\n        \n        if (isLoading) {\n            btnText.style.display = 'none';\n            btnLoading.style.display = 'inline-flex';\n            submitButton.disabled = true;\n            return;\n        }\n\n        btnText.style.display = 'inline';\n        btnLoading.style.display = 'none';\n\n        // Check if form is valid for submission\n        const hasRequiredFields = this.checkRequiredFields();\n        const hasMeasurement = this.measurementData && \n            (this.measurementData.googleMaps || this.measurementData.arcgis);\n\n        submitButton.disabled = !hasRequiredFields || !hasMeasurement;\n        getQuoteButton.disabled = !hasMeasurement;\n\n        if (!hasMeasurement) {\n            getQuoteText.style.display = 'inline';\n            getQuoteLoading.style.display = 'none';\n        }\n    }\n\n    checkRequiredFields() {\n        const requiredFields = ['firstName', 'lastName', 'email', 'phone', 'serviceType', 'streetAddress', 'city', 'state', 'zipCode'];\n        \n        return requiredFields.every(fieldName => {\n            const field = document.getElementById(fieldName);\n            return field && field.value.trim();\n        });\n    }\n\n    resetForm() {\n        if (confirm('Are you sure you want to reset the form? All entered data will be lost.')) {\n            document.getElementById('estimate-form').reset();\n            this.measurementData = null;\n            this.updateMeasurementStatus();\n            this.updateSubmitButtonState();\n            \n            // Clear validation errors\n            document.querySelectorAll('.error-message').forEach(el => el.textContent = '');\n            document.querySelectorAll('.form-input, .form-select, .form-textarea').forEach(el => {\n                el.classList.remove('error');\n            });\n            \n            // Clear measurement data\n            import('../utils/measurement-storage.js').then(({ handleFormReset }) => {\n                handleFormReset();\n            });\n        }\n    }\n\n    /**\n     * Initialize the measurement tools in the estimate form\n     */\n    initializeMeasurementTools() {\n        // Initialize ArcGIS tool by default\n        this.loadArcGISMeasurementTool();\n    }\n\n    /**\n     * Toggle between measurement tools\n     */\n    toggleMeasurementTool(toolType) {\n        const arcgisToggle = document.getElementById('arcgis-toggle');\n        const googleMapsToggle = document.getElementById('google-maps-toggle');\n        const arcgisContainer = document.getElementById('arcgis-container');\n        const googleMapsContainer = document.getElementById('google-maps-container');\n\n        // Update button states\n        document.querySelectorAll('.toggle-btn').forEach(btn => btn.classList.remove('active'));\n        \n        if (toolType === 'arcgis-3d') {\n            arcgisToggle.classList.add('active');\n            arcgisContainer.style.display = 'block';\n            googleMapsContainer.style.display = 'none';\n            \n            // Load ArcGIS if not already loaded\n            if (!this.arcgisLoaded) {\n                this.loadArcGISMeasurementTool();\n            }\n        } else if (toolType === 'google-maps') {\n            googleMapsToggle.classList.add('active');\n            arcgisContainer.style.display = 'none';\n            googleMapsContainer.style.display = 'block';\n            \n            // Load Google Maps if not already loaded\n            if (!this.googleMapsLoaded) {\n                this.loadGoogleMapsMeasurementTool();\n            }\n        }\n\n        // Update active tool\n        this.activeMeasurementTool = toolType;\n    }\n\n    /**\n     * Load ArcGIS measurement tool\n     */\n    async loadArcGISMeasurementTool() {\n        if (this.arcgisLoaded) return;\n        \n        try {\n            this.arcgisLoaded = true;\n            \n            // Load CSS first\n            const cssLink = document.createElement('link');\n            cssLink.rel = 'stylesheet';\n            cssLink.href = 'https://js.arcgis.com/4.33/esri/themes/light/main.css';\n            document.head.appendChild(cssLink);\n\n            // Load Calcite components\n            const calciteScript = document.createElement('script');\n            calciteScript.type = 'module';\n            calciteScript.src = 'https://js.arcgis.com/calcite-components/3.2.1/calcite.esm.js';\n            document.head.appendChild(calciteScript);\n\n            // Load main ArcGIS SDK\n            const scriptTag = document.createElement('script');\n            scriptTag.src = 'https://js.arcgis.com/4.33/';\n            \n            scriptTag.onload = () => {\n                // Load map components\n                const mapComponentsScript = document.createElement('script');\n                mapComponentsScript.type = 'module';\n                mapComponentsScript.src = 'https://js.arcgis.com/4.33/map-components/';\n                mapComponentsScript.onload = () => {\n                    this.initializeArcGISScene();\n                };\n                document.head.appendChild(mapComponentsScript);\n            };\n            \n            document.head.appendChild(scriptTag);\n            \n        } catch (error) {\n            console.error('Error loading ArcGIS:', error);\n            this.showArcGISError(error);\n        }\n    }\n\n    /**\n     * Initialize ArcGIS scene and measurement tools\n     */\n    initializeArcGISScene() {\n        const sceneViewContainer = document.getElementById('arcgis-scene-view');\n        const arcGISPlaceholder = document.getElementById('arcgis-placeholder');\n        const arcGISResults = document.getElementById('arcgis-results');\n        const lineResult = document.getElementById('line-result');\n        const areaResult = document.getElementById('area-result');\n\n        // Create the ArcGIS scene element\n        sceneViewContainer.innerHTML = `\n            <arcgis-scene item-id=\"5ce0de673d3b41a3bf3a217942211c4b\" style=\"height: 100%; width: 100%;\">\n                <arcgis-zoom position=\"top-left\"></arcgis-zoom>\n                <arcgis-navigation-toggle position=\"top-left\"></arcgis-navigation-toggle>\n                <arcgis-compass position=\"top-left\"></arcgis-compass>\n                <arcgis-expand id=\"expand-line\" position=\"top-right\" group=\"top-right\">\n                    <arcgis-direct-line-measurement-3d></arcgis-direct-line-measurement-3d>\n                </arcgis-expand>\n                <arcgis-expand id=\"expand-area\" position=\"top-right\" group=\"top-right\">\n                    <arcgis-area-measurement-3d></arcgis-area-measurement-3d>\n                </arcgis-expand>\n            </arcgis-scene>\n        `;\n\n        // Wait for the scene to be ready\n        setTimeout(() => {\n            const viewElement = sceneViewContainer.querySelector('arcgis-scene');\n            const directLineMeasurement3d = sceneViewContainer.querySelector('arcgis-direct-line-measurement-3d');\n            const areaMeasurement3d = sceneViewContainer.querySelector('arcgis-area-measurement-3d');\n            const expandDirectLine = sceneViewContainer.querySelector('#expand-line');\n            const expandArea = sceneViewContainer.querySelector('#expand-area');\n\n            if (viewElement && directLineMeasurement3d && areaMeasurement3d) {\n                viewElement.viewOnReady().then(() => {\n                    this.setupArcGISMeasurementObservers(\n                        expandDirectLine,\n                        expandArea,\n                        directLineMeasurement3d,\n                        areaMeasurement3d,\n                        lineResult,\n                        areaResult,\n                        arcGISResults\n                    );\n                });\n            }\n        }, 1000);\n    }\n\n    /**\n     * Set up ArcGIS measurement observers\n     */\n    setupArcGISMeasurementObservers(expandDirectLine, expandArea, directLineMeasurement3d, areaMeasurement3d, lineResult, areaResult, arcGISResults) {\n        // Observer for direct line measurement\n        const observerLine = new MutationObserver((mutations) => {\n            mutations.forEach(mutation => {\n                if (mutation.target.expanded) {\n                    directLineMeasurement3d.start();\n                    arcGISResults.style.display = 'block';\n                } else {\n                    directLineMeasurement3d.clear();\n                    areaMeasurement3d.clear();\n                    lineResult.textContent = '0 m';\n                    areaResult.textContent = '0 m';\n                    if (!expandArea.expanded) {\n                        arcGISResults.style.display = 'none';\n                    }\n                }\n            });\n        });\n        observerLine.observe(expandDirectLine, { attributeFilter: ['expanded'] });\n\n        // Observer for area measurement\n        const observerArea = new MutationObserver((mutations) => {\n            mutations.forEach(mutation => {\n                if (mutation.target.expanded) {\n                    areaMeasurement3d.start();\n                    arcGISResults.style.display = 'block';\n                } else {\n                    directLineMeasurement3d.clear();\n                    areaMeasurement3d.clear();\n                    lineResult.textContent = '0 m';\n                    areaResult.textContent = '0 m';\n                    if (!expandDirectLine.expanded) {\n                        arcGISResults.style.display = 'none';\n                    }\n                }\n            });\n        });\n        observerArea.observe(expandArea, { attributeFilter: ['expanded'] });\n\n        // Listen for measurement events\n        directLineMeasurement3d.addEventListener('measure-complete', (event) => {\n            if (event.detail && event.detail.distance) {\n                lineResult.textContent = `${event.detail.distance.toFixed(2)} ${event.detail.unit || 'm'}`;\n                this.updateProjectSizeFromMeasurement(event.detail, 'distance');\n            }\n        });\n\n        areaMeasurement3d.addEventListener('measure-complete', (event) => {\n            if (event.detail && event.detail.area) {\n                areaResult.textContent = `${event.detail.area.toFixed(2)} ${event.detail.unit || 'm'}`;\n                this.updateProjectSizeFromMeasurement(event.detail, 'area');\n            }\n        });\n    }\n\n    /**\n     * Update project size input from measurement\n     */\n    updateProjectSizeFromMeasurement(measurementData, type) {\n        if (type === 'area' && measurementData.area) {\n            // Convert square meters to square feet\n            const areaInSqFt = Math.round(measurementData.area * 10.764);\n            \n            // Update hidden fields\n            document.getElementById('calculatedSquareFootage').value = areaInSqFt;\n            document.getElementById('measurementTool').value = 'arcgis-3d';\n            document.getElementById('measurementTimestamp').value = new Date().toISOString();\n            \n            // Update measurement data\n            this.measurementData = {\n                arcgis: {\n                    area: areaInSqFt,\n                    areaInSquareFeet: areaInSqFt,\n                    coordinates: [],\n                    timestamp: new Date().toISOString()\n                },\n                activeTool: 'arcgis-3d'\n            };\n            \n            // Update UI\n            this.updateMeasurementStatus();\n            this.updateSubmitButtonState();\n        }\n    }\n\n    /**\n     * Load Google Maps measurement tool\n     */\n    async loadGoogleMapsMeasurementTool() {\n        // Implementation for Google Maps would go here\n        const googleMapsDiv = document.getElementById('google-maps-measurement');\n        googleMapsDiv.innerHTML = '<p style=\"text-align: center; padding: 2rem; color: #28a745;\">Google Maps measurement tool coming soon!</p>';\n        this.googleMapsLoaded = true;\n    }\n\n    /**\n     * Show ArcGIS error message\n     */\n    showArcGISError(error) {\n        const placeholder = document.getElementById('arcgis-placeholder');\n        if (placeholder) {\n            placeholder.innerHTML = `\n                <div style=\"text-align: center; padding: 2rem; color: #dc3545;\">\n                    <div style=\"font-size: 48px; margin-bottom: 1rem;\"></div>\n                    <h3 style=\"margin-bottom: 1rem; color: #dc3545;\">Failed to Load ArcGIS</h3>\n                    <p style=\"margin-bottom: 1.5rem; color: #6c757d;\">Unable to load the 3D measurement tool. This might be due to a network issue or service unavailability.</p>\n                    <button onclick=\"window.location.reload();\" \n                            style=\"padding: 0.5rem 1rem; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;\">Retry</button>\n                    <p style=\"margin-top: 1rem; font-size: 0.9rem; color: #6c757d;\">Please try refreshing the page or contact us directly for assistance.</p>\n                </div>\n            `;\n        }\n    }\n\n    /**\n     * Handle get quote button click\n     */\n    async handleGetQuote() {\n        if (!this.measurementData || (!this.measurementData.googleMaps && !this.measurementData.arcgis)) {\n            alert('Please measure the project area first using the map tool above.');\n            return;\n        }\n\n        const getQuoteButton = document.getElementById('get-quote');\n        const btnText = getQuoteButton.querySelector('.btn-text');\n        const btnLoading = getQuoteButton.querySelector('.btn-loading');\n\n        // Show loading state\n        btnText.style.display = 'none';\n        btnLoading.style.display = 'inline-flex';\n        getQuoteButton.disabled = true;\n\n        try {\n            // Get current form data\n            const serviceType = document.getElementById('serviceType').value || 'residential';\n            \n            // Calculate pricing\n            const pricingData = this.calculatePricing(serviceType);\n            \n            // Display pricing\n            this.displayPricing(pricingData);\n            \n        } catch (error) {\n            console.error('Error calculating pricing:', error);\n            alert('Unable to calculate pricing. Please try again.');\n        } finally {\n            // Reset button state\n            btnText.style.display = 'inline';\n            btnLoading.style.display = 'none';\n            getQuoteButton.disabled = false;\n        }\n    }\n\n    /**\n     * Calculate pricing based on measurements and service type\n     */\n    calculatePricing(serviceType = 'residential') {\n        if (!this.measurementData) {\n            throw new Error('No measurement data available');\n        }\n\n        const data = this.measurementData.googleMaps || this.measurementData.arcgis;\n        const squareFootage = data.areaInSquareFeet || data.area || 0;\n        \n        // Base pricing per square foot\n        const basePricing = {\n            residential: {\n                asphalt: { min: 3.50, max: 7.00, avg: 5.25 },\n                concrete: { min: 6.00, max: 12.00, avg: 9.00 },\n                maintenance: { min: 1.50, max: 3.00, avg: 2.25 }\n            },\n            commercial: {\n                asphalt: { min: 4.00, max: 8.50, avg: 6.25 },\n                concrete: { min: 7.00, max: 15.00, avg: 11.00 },\n                maintenance: { min: 2.00, max: 4.00, avg: 3.00 }\n            },\n            maintenance: {\n                asphalt: { min: 1.50, max: 3.50, avg: 2.50 },\n                concrete: { min: 2.00, max: 4.50, avg: 3.25 },\n                maintenance: { min: 1.00, max: 2.50, avg: 1.75 }\n            },\n            custom: {\n                asphalt: { min: 4.50, max: 9.00, avg: 6.75 },\n                concrete: { min: 8.00, max: 16.00, avg: 12.00 },\n                maintenance: { min: 2.50, max: 5.00, avg: 3.75 }\n            },\n            emergency: {\n                asphalt: { min: 5.00, max: 10.00, avg: 7.50 },\n                concrete: { min: 9.00, max: 18.00, avg: 13.50 },\n                maintenance: { min: 3.00, max: 6.00, avg: 4.50 }\n            }\n        };\n\n        const serviceTypePricing = basePricing[serviceType] || basePricing.residential;\n        \n        // Calculate costs for different materials\n        const calculations = {\n            asphalt: {\n                min: Math.round(squareFootage * serviceTypePricing.asphalt.min),\n                max: Math.round(squareFootage * serviceTypePricing.asphalt.max),\n                avg: Math.round(squareFootage * serviceTypePricing.asphalt.avg)\n            },\n            concrete: {\n                min: Math.round(squareFootage * serviceTypePricing.concrete.min),\n                max: Math.round(squareFootage * serviceTypePricing.concrete.max),\n                avg: Math.round(squareFootage * serviceTypePricing.concrete.avg)\n            },\n            maintenance: {\n                min: Math.round(squareFootage * serviceTypePricing.maintenance.min),\n                max: Math.round(squareFootage * serviceTypePricing.maintenance.max),\n                avg: Math.round(squareFootage * serviceTypePricing.maintenance.avg)\n            }\n        };\n\n        // Apply size adjustments\n        const sizeMultiplier = this.getSizeMultiplier(squareFootage);\n        const seasonMultiplier = this.getSeasonMultiplier();\n        \n        // Apply multipliers\n        Object.keys(calculations).forEach(material => {\n            calculations[material].min = Math.round(calculations[material].min * sizeMultiplier * seasonMultiplier);\n            calculations[material].max = Math.round(calculations[material].max * sizeMultiplier * seasonMultiplier);\n            calculations[material].avg = Math.round(calculations[material].avg * sizeMultiplier * seasonMultiplier);\n        });\n\n        return {\n            squareFootage,\n            serviceType,\n            calculations,\n            factors: {\n                sizeMultiplier,\n                seasonMultiplier\n            },\n            timestamp: new Date().toISOString()\n        };\n    }\n\n    /**\n     * Get size-based pricing multiplier\n     */\n    getSizeMultiplier(squareFootage) {\n        if (squareFootage < 500) return 1.2; // Small projects cost more per sq ft\n        if (squareFootage < 1000) return 1.1;\n        if (squareFootage < 2000) return 1.0;\n        if (squareFootage < 5000) return 0.95;\n        return 0.9; // Large projects get discounts\n    }\n\n    /**\n     * Get seasonal pricing multiplier\n     */\n    getSeasonMultiplier() {\n        const month = new Date().getMonth(); // 0-11\n        \n        // Winter months (Dec, Jan, Feb) - higher pricing\n        if (month === 11 || month === 0 || month === 1) return 1.15;\n        \n        // Peak season (Mar, Apr, May, Sep, Oct) - standard pricing\n        if (month >= 2 && month <= 4 || month >= 8 && month <= 9) return 1.0;\n        \n        // Summer months (Jun, Jul, Aug) - slight discount\n        return 0.95;\n    }\n\n    /**\n     * Display pricing information\n     */\n    displayPricing(pricingData) {\n        const pricingDisplay = document.getElementById('pricing-display');\n        const pricingDetails = document.getElementById('pricing-details');\n        \n        if (!pricingDisplay || !pricingDetails) return;\n\n        const { squareFootage, serviceType, calculations, factors } = pricingData;\n        \n        pricingDetails.innerHTML = `\n            <div class=\"pricing-overview\">\n                <div class=\"pricing-stat\">\n                    <span class=\"stat-label\">Project Area:</span>\n                    <span class=\"stat-value\">${squareFootage.toLocaleString()} sq ft</span>\n                </div>\n                <div class=\"pricing-stat\">\n                    <span class=\"stat-label\">Service Type:</span>\n                    <span class=\"stat-value\">${this.formatServiceType(serviceType)}</span>\n                </div>\n            </div>\n            \n            <div class=\"material-pricing\">\n                <h4>Pricing by Material</h4>\n                \n                <div class=\"material-option\">\n                    <div class=\"material-header\">\n                        <h5> Asphalt Paving</h5>\n                        <p>Durable, cost-effective option for driveways and parking lots</p>\n                    </div>\n                    <div class=\"price-range\">\n                        <span class=\"price-min\">$${calculations.asphalt.min.toLocaleString()}</span>\n                        <span class=\"price-separator\">-</span>\n                        <span class=\"price-max\">$${calculations.asphalt.max.toLocaleString()}</span>\n                        <span class=\"price-avg\">Avg: $${calculations.asphalt.avg.toLocaleString()}</span>\n                    </div>\n                </div>\n                \n                <div class=\"material-option\">\n                    <div class=\"material-header\">\n                        <h5> Concrete Paving</h5>\n                        <p>Long-lasting, premium option with excellent durability</p>\n                    </div>\n                    <div class=\"price-range\">\n                        <span class=\"price-min\">$${calculations.concrete.min.toLocaleString()}</span>\n                        <span class=\"price-separator\">-</span>\n                        <span class=\"price-max\">$${calculations.concrete.max.toLocaleString()}</span>\n                        <span class=\"price-avg\">Avg: $${calculations.concrete.avg.toLocaleString()}</span>\n                    </div>\n                </div>\n                \n                <div class=\"material-option\">\n                    <div class=\"material-header\">\n                        <h5> Maintenance Services</h5>\n                        <p>Repairs, sealing, and restoration services</p>\n                    </div>\n                    <div class=\"price-range\">\n                        <span class=\"price-min\">$${calculations.maintenance.min.toLocaleString()}</span>\n                        <span class=\"price-separator\">-</span>\n                        <span class=\"price-max\">$${calculations.maintenance.max.toLocaleString()}</span>\n                        <span class=\"price-avg\">Avg: $${calculations.maintenance.avg.toLocaleString()}</span>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"pricing-factors\">\n                <h4>Pricing Factors Applied</h4>\n                <ul>\n                    <li>Project Size: ${this.formatMultiplier(factors.sizeMultiplier)} (${this.getSizeDescription(squareFootage)})</li>\n                    <li>Seasonal Rate: ${this.formatMultiplier(factors.seasonMultiplier)} (${this.getSeasonDescription()})</li>\n                    <li>Service Type: ${this.formatServiceType(serviceType)}</li>\n                </ul>\n            </div>\n            \n            <div class=\"pricing-actions\">\n                <button type=\"button\" class=\"btn btn-primary\" onclick=\"document.getElementById('submit-estimate').scrollIntoView({behavior: 'smooth'})\">\n                    Request Detailed Estimate\n                </button>\n                <button type=\"button\" class=\"btn btn-outline\" onclick=\"window.print()\">\n                    Print Quote\n                </button>\n            </div>\n        `;\n        \n        pricingDisplay.style.display = 'block';\n        pricingDisplay.scrollIntoView({ behavior: 'smooth' });\n    }\n\n    /**\n     * Format service type for display\n     */\n    formatServiceType(serviceType) {\n        const types = {\n            'residential': 'Residential Paving',\n            'commercial': 'Commercial Paving',\n            'maintenance': 'Maintenance Services',\n            'custom': 'Custom Projects',\n            'emergency': 'Emergency Repairs'\n        };\n        return types[serviceType] || 'Residential Paving';\n    }\n\n    /**\n     * Format multiplier for display\n     */\n    formatMultiplier(multiplier) {\n        const percentage = Math.round((multiplier - 1) * 100);\n        if (percentage > 0) return `+${percentage}%`;\n        if (percentage < 0) return `${percentage}%`;\n        return 'Standard';\n    }\n\n    /**\n     * Get size description\n     */\n    getSizeDescription(squareFootage) {\n        if (squareFootage < 500) return 'Small project';\n        if (squareFootage < 1000) return 'Medium project';\n        if (squareFootage < 2000) return 'Large project';\n        if (squareFootage < 5000) return 'Very large project';\n        return 'Commercial scale';\n    }\n\n    /**\n     * Get season description\n     */\n    getSeasonDescription() {\n        const month = new Date().getMonth();\n        \n        if (month === 11 || month === 0 || month === 1) return 'Winter rates';\n        if (month >= 2 && month <= 4 || month >= 8 && month <= 9) return 'Peak season';\n        return 'Summer rates';\n    }\n}\n\nexport default EstimateForm;\n"],"file":"chunks/chunk-rmrma-TF.js"}